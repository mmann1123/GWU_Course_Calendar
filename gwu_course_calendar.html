<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GWU Courses - Spring 2026</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f8f9fa; padding: 0; }
        .main-content { padding: 20px; }

        /* Read the Docs style navigation */
        .rtd-navbar { background-color: #2980b9; color: white; padding: 0 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); position: sticky; top: 0; z-index: 1000; }
        .rtd-navbar-content { display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto; height: 50px; }
        .rtd-navbar-left { display: flex; align-items: center; gap: 20px; }
        .rtd-navbar-title { font-size: 18px; font-weight: 600; color: white; text-decoration: none; display: flex; align-items: center; gap: 8px; }
        .rtd-navbar-right { display: flex; align-items: center; gap: 15px; }
        .rtd-nav-link { color: rgba(255,255,255,0.9); text-decoration: none; font-size: 14px; font-weight: 500; padding: 8px 14px; border-radius: 5px; transition: all 0.2s; display: flex; align-items: center; gap: 6px; }
        .rtd-nav-link:hover { background-color: rgba(255,255,255,0.15); color: white; }
        .github-icon { width: 20px; height: 20px; fill: currentColor; }

        /* Footer */
        .rtd-footer { background-color: #343131; color: #d9d9d9; padding: 30px 20px; margin-top: 40px; border-top: 4px solid #2980b9; }
        .rtd-footer-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; }
        .rtd-footer-left { font-size: 13px; }
        .rtd-footer-links { display: flex; gap: 20px; }
        .rtd-footer-link { color: #2980b9; text-decoration: none; font-size: 14px; font-weight: 500; display: flex; align-items: center; gap: 6px; transition: all 0.2s; }
        .rtd-footer-link:hover { color: #5dade2; }
        .rtd-footer-attribution { margin-top: 15px; padding-top: 15px; border-top: 1px solid #4a4a4a; text-align: center; font-size: 12px; color: #999; }
        .header { background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(26,115,232,0.3); }
        .header h1 { font-size: 30px; margin-bottom: 10px; font-weight: 700; letter-spacing: -0.5px; }
        .header p { font-size: 14px; opacity: 0.92; font-weight: 400; }
        .stats { background-color: white; padding: 24px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); display: flex; gap: 50px; }
        .stats-item { color: #5f6368; font-size: 14px; font-weight: 500; }
        .stats-number { font-size: 36px; font-weight: 700; background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; display: block; margin-bottom: 5px; }
        .calendar-container { background-color: white; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.1); overflow-x: auto; }
        .calendar-header { display: grid; grid-template-columns: 80px repeat(5, minmax(180px, 1fr)); border-bottom: 2px solid #e0e0e0; background-color: #f8f9fa; position: sticky; top: 0; z-index: 10; }
        .day-header { padding: 15px 10px; text-align: center; font-weight: 600; font-size: 14px; color: #3c4043; border-right: 1px solid #e0e0e0; cursor: pointer; transition: all 0.2s ease; }
        .day-header:hover { background-color: #e3f2fd; color: #1a73e8; }
        .day-header.active { background-color: #1a73e8; color: white; }
        .day-header:last-child { border-right: none; }
        .filter-controls { background-color: white; padding: 18px 24px; margin-bottom: 10px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); display: flex; align-items: center; gap: 15px; flex-wrap: wrap; }
        .filter-btn { padding: 9px 18px; border: 1px solid #1a73e8; background-color: white; color: #1a73e8; border-radius: 8px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
        .filter-btn:hover { background-color: #1a73e8; color: white; transform: translateY(-1px); box-shadow: 0 3px 8px rgba(26,115,232,0.25); }
        .filter-btn:active { transform: translateY(0); }
        .filter-text { color: #5f6368; font-size: 14px; font-weight: 500; }
        .calendar-body { display: grid; grid-template-columns: 80px repeat(5, minmax(180px, 1fr)); position: relative; }
        .time-column { border-right: 2px solid #e0e0e0; background-color: #fafafa; }
        .time-slot { height: 60px; padding: 8px; font-size: 12px; font-weight: 500; color: #70757a; text-align: right; border-bottom: 1px solid #f0f0f0; }
        .day-column { border-right: 1px solid #e0e0e0; position: relative; min-height: 100%; }
        .day-column:last-child { border-right: none; }
        .hour-line { position: absolute; width: 100%; height: 1px; background-color: #f0f0f0; left: 0; }
        .course-block { position: absolute; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 5px; padding: 8px; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.15); overflow: visible; z-index: 1; border: 1px solid rgba(255,255,255,0.3); }
        .course-block:hover { transform: translateY(-2px) scale(1.02); box-shadow: 0 6px 16px rgba(0,0,0,0.25); z-index: 100; }
        .course-block:hover .tooltip { visibility: visible; opacity: 1; }
        .tooltip { visibility: hidden; opacity: 0; position: absolute; left: 105%; top: 0; background-color: #2d2d2d; color: white; padding: 12px 15px; border-radius: 8px; font-size: 12px; white-space: nowrap; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.3); transition: opacity 0.3s, visibility 0.3s; pointer-events: none; }
        .tooltip::before { content: ''; position: absolute; right: 100%; top: 15px; border: 6px solid transparent; border-right-color: #2d2d2d; }
        .tooltip-row { margin-bottom: 6px; }
        .tooltip-row:last-child { margin-bottom: 0; }
        .tooltip-label { font-weight: 600; color: #a0a0a0; display: inline-block; min-width: 80px; }
        .tooltip-value { color: white; }
        .course-number { font-weight: 700; color: white; font-size: 11px; margin-bottom: 3px; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .course-name { color: rgba(255,255,255,0.95); font-size: 10px; line-height: 1.3; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; }
        .course-time { color: rgba(255,255,255,0.85); font-size: 9px; margin-top: 4px; font-weight: 600; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); z-index: 1000; animation: fadeIn 0.2s; backdrop-filter: blur(2px); }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; border-radius: 16px; padding: 32px; max-width: 580px; width: 90%; max-height: 85vh; overflow-y: auto; box-shadow: 0 12px 48px rgba(0,0,0,0.25), 0 4px 16px rgba(0,0,0,0.12); animation: slideIn 0.3s; }
        @keyframes slideIn { from { transform: translate(-50%, -55%); opacity: 0; } to { transform: translate(-50%, -50%); opacity: 1; } }
        .modal-content::-webkit-scrollbar { width: 8px; }
        .modal-content::-webkit-scrollbar-track { background: #f1f3f4; border-radius: 4px; }
        .modal-content::-webkit-scrollbar-thumb { background: #dadce0; border-radius: 4px; }
        .modal-content::-webkit-scrollbar-thumb:hover { background: #bdc1c6; }
        .modal-header { margin-bottom: 28px; padding-bottom: 24px; border-bottom: 2px solid #e8eaed; }
        .status-badge { display: inline-block; padding: 6px 14px; border-radius: 8px; font-size: 12px; font-weight: 700; margin-bottom: 14px; text-transform: uppercase; letter-spacing: 0.5px; }
        .status-open { background: linear-gradient(135deg, #34a853 0%, #0f9d58 100%); color: white; box-shadow: 0 2px 6px rgba(52,168,83,0.3); }
        .status-closed, .status-waitlist { background: linear-gradient(135deg, #ea4335 0%, #d33b2c 100%); color: white; box-shadow: 0 2px 6px rgba(234,67,53,0.3); }
        .modal-course-number { font-size: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; margin-bottom: 10px; letter-spacing: 0.3px; }
        .modal-course-name { font-size: 24px; font-weight: 700; color: #202124; line-height: 1.3; margin-bottom: 4px; }
        .modal-body { margin-bottom: 20px; }
        .detail-row { display: flex; margin-bottom: 18px; align-items: flex-start; padding: 10px 0; border-bottom: 1px solid #f1f3f4; }
        .detail-row:last-child { border-bottom: none; }
        .detail-label { font-weight: 600; color: #5f6368; min-width: 130px; font-size: 14px; }
        .detail-value { color: #202124; font-size: 14px; flex: 1; line-height: 1.5; font-weight: 500; }
        .close-btn { position: absolute; top: 24px; right: 24px; font-size: 28px; color: #5f6368; cursor: pointer; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.2s; }
        .close-btn:hover { background-color: #f1f3f4; transform: scale(1.1); color: #202124; }
        .legend { margin-top: 20px; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .legend-title { font-weight: 700; margin-bottom: 12px; color: #202124; font-size: 16px; }
        .legend-item { display: block; margin-bottom: 8px; font-size: 13px; color: #5f6368; line-height: 1.6; }
        .legend-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px 20px; margin-top: 15px; }
        .legend-grid-item { display: flex; align-items: center; font-size: 13px; color: #202124; }
        .color-box { display: inline-block; width: 18px; height: 18px; border-radius: 4px; margin-right: 8px; vertical-align: middle; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); flex-shrink: 0; }

        /* Tabs */
        .tabs-container { background-color: white; padding: 12px 24px; margin-bottom: 10px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); display: flex; gap: 12px; }
        .tab-btn { padding: 12px 24px; border: none; background-color: #f1f3f4; color: #5f6368; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .tab-btn:hover { background-color: #e8f0fe; color: #1a73e8; transform: translateY(-1px); box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
        .tab-btn:active { transform: translateY(0); }
        .tab-btn.active { background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%); color: white; box-shadow: 0 3px 8px rgba(26,115,232,0.3); }
        .tab-content { display: block; }

        /* Instructor Selector */
        .instructor-selector-wrapper { position: relative; }
        .instructor-dropdown { display: none; position: absolute; top: 100%; left: 0; background-color: white; border: 1px solid #dadce0; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.12), 0 2px 6px rgba(0,0,0,0.08); min-width: 320px; max-width: 420px; z-index: 100; margin-top: 8px; overflow: hidden; }
        .instructor-dropdown.show { display: block; animation: dropdownSlide 0.2s ease-out; }
        @keyframes dropdownSlide { from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: translateY(0); } }
        .instructor-dropdown-header { display: flex; justify-content: space-between; padding: 12px 16px; background: linear-gradient(135deg, #f8f9fa 0%, #e8eaed 100%); border-bottom: 1px solid #dadce0; gap: 10px; }
        .dropdown-action-btn { padding: 8px 16px; border: 1px solid #1a73e8; background-color: white; color: #1a73e8; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s; flex: 1; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
        .dropdown-action-btn:hover { background-color: #1a73e8; color: white; transform: translateY(-1px); box-shadow: 0 2px 6px rgba(26,115,232,0.3); }
        .dropdown-action-btn:active { transform: translateY(0); }
        .instructor-list { max-height: 340px; overflow-y: auto; padding: 8px; background-color: #fafafa; }
        .instructor-list::-webkit-scrollbar { width: 8px; }
        .instructor-list::-webkit-scrollbar-track { background: #f1f3f4; border-radius: 4px; }
        .instructor-list::-webkit-scrollbar-thumb { background: #dadce0; border-radius: 4px; }
        .instructor-list::-webkit-scrollbar-thumb:hover { background: #bdc1c6; }
        .instructor-checkbox-item { display: flex; align-items: center; padding: 10px 12px; margin-bottom: 4px; border-radius: 8px; cursor: pointer; transition: all 0.2s; background-color: white; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .instructor-checkbox-item:hover { background-color: #e8f0fe; transform: translateX(4px); box-shadow: 0 2px 6px rgba(26,115,232,0.15); }
        .instructor-checkbox-item input[type="checkbox"] { margin-right: 12px; cursor: pointer; width: 18px; height: 18px; accent-color: #1a73e8; }
        .instructor-checkbox-item label { cursor: pointer; font-size: 13px; color: #202124; flex: 1; display: flex; align-items: center; gap: 10px; font-weight: 500; }
        .instructor-color-indicator { display: inline-block; width: 14px; height: 14px; border-radius: 50%; border: 2px solid white; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }

        /* Class List */
        .planning-container, .conflicts-container { background-color: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .planning-container h2, .conflicts-container h2 { color: #202124; margin-bottom: 10px; font-size: 24px; }
        .tab-description { color: #5f6368; margin-bottom: 25px; font-size: 14px; }
        .instructor-schedule { margin-bottom: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border-left: 4px solid #1a73e8; }
        .instructor-schedule-header { font-size: 18px; font-weight: 700; color: #202124; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .instructor-schedule-courses { display: grid; gap: 10px; }
        .schedule-course-item { padding: 12px 15px; background-color: white; border-radius: 6px; border-left: 3px solid #667eea; }
        .schedule-course-title { font-weight: 600; color: #202124; margin-bottom: 5px; }
        .schedule-course-details { font-size: 13px; color: #5f6368; }

        /* Room Conflicts */
        .conflict-group { margin-bottom: 25px; padding: 20px; background-color: #fff3cd; border-radius: 8px; border-left: 4px solid #ff6b6b; position: relative; }
        .conflict-header { font-size: 16px; font-weight: 700; color: #721c24; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .conflict-severity { display: inline-block; padding: 3px 10px; background-color: #ff6b6b; color: white; border-radius: 12px; font-size: 11px; font-weight: 700; }
        .conflict-ignore-btn { position: absolute; top: 15px; right: 15px; padding: 6px 12px; background-color: #5f6368; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s; }
        .conflict-ignore-btn:hover { background-color: #3c4043; transform: scale(1.05); }
        .conflict-courses { display: grid; gap: 12px; margin-top: 15px; }
        .conflict-course-item { padding: 12px 15px; background-color: white; border-radius: 6px; border-left: 3px solid #ff6b6b; }
        .conflict-course-header { font-weight: 600; color: #202124; margin-bottom: 5px; }
        .conflict-course-details { font-size: 13px; color: #5f6368; }
        .no-conflicts { padding: 30px; text-align: center; color: #5f6368; font-size: 16px; }
        .conflict-indicator { border: 3px solid #ff6b6b !important; box-shadow: 0 0 0 3px rgba(255,107,107,0.2) !important; }
        .conflict-hidden { display: none; }

        /* Edit Mode Styles */
        .edit-container { background-color: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .edit-container h2 { color: #202124; margin-bottom: 10px; font-size: 24px; }

        .edit-toolbar-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; }
        .edit-toolbar-bottom { display: flex; gap: 15px; justify-content: center; margin-top: 20px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; }

        .edit-action-btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .edit-action-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .btn-primary { background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%); color: white; }
        .btn-secondary { background-color: #f1f3f4; color: #5f6368; }
        .btn-secondary:hover { background-color: #e8eaed; }
        .btn-danger { background: linear-gradient(135deg, #ea4335 0%, #d33b2c 100%); color: white; }
        .btn-info { background: linear-gradient(135deg, #fbbc04 0%, #f9ab00 100%); color: #202124; }
        .btn-export { background: linear-gradient(135deg, #34a853 0%, #0f9d58 100%); color: white; }
        .btn-import { background: linear-gradient(135deg, #4285f4 0%, #1a73e8 100%); color: white; }
        .btn-save { background: linear-gradient(135deg, #9334e6 0%, #7c3aed 100%); color: white; }

        .edit-status { font-size: 14px; color: #5f6368; }
        .edit-status #editCount { font-weight: 700; color: #ea4335; font-size: 18px; }

        .calendar-container.edit-mode { border: 3px solid #fbbc04; box-shadow: 0 4px 16px rgba(251,188,4,0.2); }
        .calendar-container.edit-mode .course-block { cursor: pointer; border: 2px solid rgba(255,255,255,0.5); }
        .calendar-container.edit-mode .course-block:hover { border: 2px solid white; transform: translateY(-3px) scale(1.03); }
        .calendar-container.edit-mode .course-block.edited { position: absolute; }
        .calendar-container.edit-mode .course-block.edited::after { content: '⚠️'; position: absolute; top: 2px; right: 2px; font-size: 12px; }

        /* Edit Modal Styles */
        .edit-modal-content { max-width: 700px; max-height: 90vh; overflow-y: auto; }
        .edit-modal-content h2 { font-size: 22px; color: #1a73e8; margin-bottom: 20px; }

        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 600; color: #202124; margin-bottom: 8px; font-size: 14px; }
        .form-group input, .form-group select { width: 100%; padding: 10px 12px; border: 1px solid #dadce0; border-radius: 6px; font-size: 14px; transition: all 0.2s; }
        .form-group input:focus, .form-group select:focus { border-color: #1a73e8; outline: none; box-shadow: 0 0 0 3px rgba(26,115,232,0.1); }

        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }

        .required { color: #ea4335; font-weight: 700; }

        .day-checkboxes { display: flex; gap: 15px; margin-top: 10px; flex-wrap: wrap; }
        .day-checkboxes label { display: flex; align-items: center; gap: 6px; font-size: 13px; font-weight: 500; cursor: pointer; padding: 8px 12px; background-color: #f1f3f4; border-radius: 6px; transition: all 0.2s; }
        .day-checkboxes label:hover { background-color: #e8f0fe; }
        .day-checkboxes input[type="checkbox"]:checked + * { color: #1a73e8; }
        .day-checkboxes input[type="checkbox"] { accent-color: #1a73e8; width: 16px; height: 16px; }

        .error-message { color: #ea4335; font-size: 13px; margin-top: 5px; padding: 8px; background-color: #fce8e6; border-radius: 4px; }

        .modal-actions { display: flex; gap: 12px; justify-content: flex-end; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e8eaed; }
        .modal-actions button { padding: 10px 20px; }
    </style>
</head>
<body>
    <!-- Read the Docs style navigation -->
    <nav class="rtd-navbar">
        <div class="rtd-navbar-content">
            <div class="rtd-navbar-left">
                <span class="rtd-navbar-title">🎓 GWU Course Calendar</span>
            </div>
            <div class="rtd-navbar-right">
                <a href="https://github.com/mmann1123/GWU_Course_Calendar" target="_blank" class="rtd-nav-link">
                    <svg class="github-icon" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                    GitHub
                </a>
                <a href="https://github.com/mmann1123/GWU_Course_Calendar/issues" target="_blank" class="rtd-nav-link">
                    Report Issue
                </a>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div class="header">
            <h1>🗓️ GWU Courses - Spring 2026</h1>
            <p>Interactive Course Schedule | Scraped from GWU website on October 29, 2025</p>
        </div>

    <div class="stats">
        <div class="stats-item"><span class="stats-number" id="totalCourses">0</span><span>Total Courses</span></div>
        <div class="stats-item"><span class="stats-number" id="totalInstructors">0</span><span>Instructors</span></div>
    </div>

    <div class="tabs-container">
        <button class="tab-btn active" data-tab="all-courses" onclick="switchTab('all-courses')">📅 All Courses</button>
        <button class="tab-btn" data-tab="planning-mode" onclick="switchTab('planning-mode')">📋 Class List</button>
        <button class="tab-btn" data-tab="room-conflicts" onclick="switchTab('room-conflicts')">⚠️ Room Conflicts</button>
        <button class="tab-btn" data-tab="edit-schedule" onclick="switchTab('edit-schedule')">✏️ Edit Schedule</button>
    </div>

    <div class="filter-controls" id="mainCalendarFilters">
        <button class="filter-btn" onclick="showAllDays()">Show All Days</button>
        <div class="instructor-selector-wrapper">
            <button class="filter-btn" id="levelDropdownBtn" onclick="toggleLevelDropdown()">
                <span id="levelBtnText">All Levels</span> ▼
            </button>
            <div class="instructor-dropdown" id="levelDropdown">
                <div class="instructor-list" style="max-height: 200px;">
                    <div class="instructor-checkbox-item" onclick="setLevelFilter('all')">
                        <label style="cursor: pointer;">All Levels</label>
                    </div>
                    <div class="instructor-checkbox-item" onclick="setLevelFilter('undergrad')">
                        <label style="cursor: pointer;">Undergrad (< 6000)</label>
                    </div>
                    <div class="instructor-checkbox-item" onclick="setLevelFilter('grad')">
                        <label style="cursor: pointer;">Grad (>= 6000)</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="instructor-selector-wrapper">
            <button class="filter-btn" id="instructorDropdownBtn" onclick="toggleInstructorDropdown()">
                <span id="instructorBtnText">All Instructors</span> ▼
            </button>
            <div class="instructor-dropdown" id="instructorDropdown">
                <div class="instructor-dropdown-header">
                    <button class="dropdown-action-btn" onclick="selectAllInstructors()">Select All</button>
                    <button class="dropdown-action-btn" onclick="clearAllInstructors()">Clear All</button>
                </div>
                <div class="instructor-list" id="instructorList"></div>
            </div>
        </div>
        <span class="filter-text" id="filterStatus">Showing all days, all instructors</span>
    </div>

    <div class="tab-content" id="all-courses-tab">
        <div class="calendar-container">
            <div class="calendar-header">
                <div class="day-header" style="background-color: white; cursor: default;"></div>
                <div class="day-header" data-day="monday" onclick="filterDay('monday')">Monday</div>
                <div class="day-header" data-day="tuesday" onclick="filterDay('tuesday')">Tuesday</div>
                <div class="day-header" data-day="wednesday" onclick="filterDay('wednesday')">Wednesday</div>
                <div class="day-header" data-day="thursday" onclick="filterDay('thursday')">Thursday</div>
                <div class="day-header" data-day="friday" onclick="filterDay('friday')">Friday</div>
            </div>

            <div class="calendar-body">
                <div class="time-column" id="timeColumn"></div>
                <div class="day-column" id="monday"></div>
                <div class="day-column" id="tuesday"></div>
                <div class="day-column" id="wednesday"></div>
                <div class="day-column" id="thursday"></div>
                <div class="day-column" id="friday"></div>
            </div>
        </div>

        <div class="legend" id="instructorLegend"></div>
    </div>

    <div class="tab-content" id="planning-mode-tab" style="display: none;">
        <div class="planning-container">
            <h2>Class List - Instructor Schedules</h2>
            <p class="tab-description">View individual instructor schedules and identify potential conflicts</p>
            <div id="planningModeContent"></div>
        </div>
    </div>

    <div class="tab-content" id="room-conflicts-tab" style="display: none;">
        <div class="conflicts-container">
            <h2>Room Conflicts Detection</h2>
            <p class="tab-description">Courses scheduled in the same room at overlapping times</p>
            <div id="conflictsContent"></div>
        </div>
    </div>

    <div class="tab-content" id="edit-schedule-tab" style="display: none;">
        <div class="edit-container">
            <h2>Edit Schedule</h2>
            <p class="tab-description">Add, remove, or modify courses. Changes are saved locally until exported.</p>

            <div class="edit-toolbar-top">
                <button class="edit-action-btn btn-primary" onclick="openAddCourseModal()">
                    ➕ Add New Course
                </button>
                <span class="edit-status" id="editStatus">
                    <span id="editCount">0</span> unsaved changes
                </span>
            </div>

            <!-- Edit Mode Filters -->
            <div class="filter-controls" style="margin: 20px 0;">
                <div class="instructor-selector-wrapper">
                    <button class="filter-btn" id="editRoomDropdownBtn" onclick="toggleEditRoomDropdown()">
                        <span id="editRoomBtnText">All Rooms</span> ▼
                    </button>
                    <div class="instructor-dropdown" id="editRoomDropdown">
                        <div class="instructor-list" id="editRoomList" style="max-height: 300px;"></div>
                    </div>
                </div>
                <div class="instructor-selector-wrapper">
                    <button class="filter-btn" id="editLevelDropdownBtn" onclick="toggleEditLevelDropdown()">
                        <span id="editLevelBtnText">All Levels</span> ▼
                    </button>
                    <div class="instructor-dropdown" id="editLevelDropdown">
                        <div class="instructor-list" style="max-height: 200px;">
                            <div class="instructor-checkbox-item" onclick="setEditLevelFilter('all')">
                                <label style="cursor: pointer;">All Levels</label>
                            </div>
                            <div class="instructor-checkbox-item" onclick="setEditLevelFilter('undergrad')">
                                <label style="cursor: pointer;">Undergrad (< 6000)</label>
                            </div>
                            <div class="instructor-checkbox-item" onclick="setEditLevelFilter('grad')">
                                <label style="cursor: pointer;">Grad (>= 6000)</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="instructor-selector-wrapper">
                    <button class="filter-btn" id="editInstructorDropdownBtn" onclick="toggleEditInstructorDropdown()">
                        <span id="editInstructorBtnText">All Instructors</span> ▼
                    </button>
                    <div class="instructor-dropdown" id="editInstructorDropdown">
                        <div class="instructor-dropdown-header">
                            <button class="dropdown-action-btn" onclick="selectAllEditInstructors()">Select All</button>
                            <button class="dropdown-action-btn" onclick="clearAllEditInstructors()">Clear All</button>
                        </div>
                        <div id="editInstructorList" class="instructor-list"></div>
                    </div>
                </div>
                <div id="editFilterStatus" style="color: #5f6368; font-size: 14px; margin-left: 15px;">

                </div>
            </div>

            <div class="calendar-container edit-mode">
                <div class="calendar-header">
                    <div class="day-header" style="background-color: white; cursor: default;"></div>
                    <div class="day-header">Monday</div>
                    <div class="day-header">Tuesday</div>
                    <div class="day-header">Wednesday</div>
                    <div class="day-header">Thursday</div>
                    <div class="day-header">Friday</div>
                </div>

                <div class="calendar-body" id="editCalendarBody">
                    <div class="time-column" id="editTimeColumn"></div>
                    <div class="day-column" id="edit-monday"></div>
                    <div class="day-column" id="edit-tuesday"></div>
                    <div class="day-column" id="edit-wednesday"></div>
                    <div class="day-column" id="edit-thursday"></div>
                    <div class="day-column" id="edit-friday"></div>
                </div>
            </div>

            <div class="edit-toolbar-bottom">
                <button class="edit-action-btn btn-export" onclick="exportToCSV()">
                    📥 Export to CSV
                </button>
                <button class="edit-action-btn btn-import" onclick="document.getElementById('csvFileInput').click()">
                    📤 Import CSV
                </button>
                <input type="file" id="csvFileInput" accept=".csv" style="display: none;" onchange="handleCSVImport(event)">
            </div>

            <!-- Edit Mode Conflicts Section -->
            <div id="editConflictsContainer" style="margin-top: 30px;">
                <h3 style="margin: 0 0 15px 0; color: #202124;">⚠️ Schedule Conflicts</h3>
                <div id="editConflictsContent">
                    <div style="padding: 20px; text-align: center; color: #5f6368;">
                        Loading conflicts...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div class="modal-header">
                <div id="statusBadge"></div>
                <div class="modal-course-number" id="modalCourseNumber"></div>
                <div class="modal-course-name" id="modalCourseName"></div>
            </div>
            <div class="modal-body">
                <div class="detail-row"><div class="detail-label">CRN:</div><div class="detail-value" id="modalCRN"></div></div>
                <div class="detail-row"><div class="detail-label">Instructor:</div><div class="detail-value" id="modalInstructor"></div></div>
                <div class="detail-row"><div class="detail-label">Meeting Time:</div><div class="detail-value" id="modalTime"></div></div>
                <div class="detail-row"><div class="detail-label">Days:</div><div class="detail-value" id="modalDays"></div></div>
                <div class="detail-row"><div class="detail-label">Building:</div><div class="detail-value" id="modalBuilding"></div></div>
                <div class="detail-row"><div class="detail-label">Room:</div><div class="detail-value" id="modalRoom"></div></div>
                <div class="detail-row"><div class="detail-label">Credits:</div><div class="detail-value" id="modalCredits"></div></div>
                <div class="detail-row"><div class="detail-label">Semester:</div><div class="detail-value" id="modalDates"></div></div>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content edit-modal-content">
            <span class="close-btn" onclick="closeEditModal()">&times;</span>
            <div class="modal-header">
                <h2 id="editModalTitle">Edit Course</h2>
            </div>
            <div class="modal-body">
                <form id="editCourseForm" onsubmit="saveCourseEdit(event)">
                    <input type="hidden" id="editCRN">
                    <input type="hidden" id="originalCRN">

                    <div class="form-row">
                        <div class="form-group">
                            <label for="editSubject">Subject Code <span class="required">*</span></label>
                            <input type="text" id="editSubject" required maxlength="10" placeholder="GEOG">
                        </div>
                        <div class="form-group">
                            <label for="editCourseNum">Course Number <span class="required">*</span></label>
                            <input type="text" id="editCourseNum" required maxlength="10" placeholder="1001">
                        </div>
                        <div class="form-group">
                            <label for="editSection">Section <span class="required">*</span></label>
                            <input type="text" id="editSection" required maxlength="10" placeholder="10">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="editCRNInput">CRN <span class="required">*</span></label>
                            <input type="text" id="editCRNInput" required maxlength="10" placeholder="XXXXX">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="editTitle">Course Title <span class="required">*</span></label>
                        <input type="text" id="editTitle" required placeholder="Introduction to Geography">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="editCredits">Credits <span class="required">*</span></label>
                            <input type="number" id="editCredits" required step="0.01" min="0" max="20" placeholder="3.00">
                        </div>
                        <div class="form-group">
                            <label for="editInstructor">Instructor <span class="required">*</span></label>
                            <input type="text" id="editInstructor" required placeholder="Last, F" list="instructorList">
                            <datalist id="instructorList"></datalist>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Days <span class="required">*</span></label>
                        <div class="day-checkboxes">
                            <label><input type="checkbox" name="editDay" value="M"> Monday</label>
                            <label><input type="checkbox" name="editDay" value="T"> Tuesday</label>
                            <label><input type="checkbox" name="editDay" value="W"> Wednesday</label>
                            <label><input type="checkbox" name="editDay" value="R"> Thursday</label>
                            <label><input type="checkbox" name="editDay" value="F"> Friday</label>
                        </div>
                        <div id="daysError" class="error-message" style="display: none;">Please select at least one day</div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="editStartTime">Start Time <span class="required">*</span></label>
                            <select id="editStartTime" required></select>
                        </div>
                        <div class="form-group">
                            <label for="editEndTime">End Time <span class="required">*</span></label>
                            <select id="editEndTime" required></select>
                        </div>
                    </div>
                    <div id="timeError" class="error-message" style="display: none;">End time must be after start time</div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="editBuilding">Building</label>
                            <input type="text" id="editBuilding" placeholder="1957 E">
                        </div>
                        <div class="form-group">
                            <label for="editRoom">Room</label>
                            <input type="text" id="editRoom" placeholder="B12">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="editDates">Semester Dates</label>
                        <input type="text" id="editDates" placeholder="01/12/26 - 04/27/26">
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="closeEditModal()">Cancel</button>
                        <button type="button" class="btn-danger" id="deleteCourseBtn" onclick="deleteCourse()">🗑️ Delete Course</button>
                        <button type="button" class="btn-info" id="duplicateCourseBtn" onclick="duplicateCourse()">📋 Duplicate</button>
                        <button type="submit" class="btn-primary">💾 Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        const courses = [{"status": "OPEN", "crn": "44900", "subject": "CSCI", "course_num": "1012", "section": "10", "title": "Introduction to Programming with Python", "credits": "3.00", "instructor": "Goldfrank, J", "days": "M", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "1957 E", "room": "213", "course_number": "CSCI 1012"}, {"status": "OPEN", "crn": "44980", "subject": "CSCI", "course_num": "1012", "section": "30", "title": "Introduction to Programming with Python", "credits": "0.00", "instructor": "Goldfrank, J", "days": "W", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "ROME", "room": "B103", "course_number": "CSCI 1012"}, {"status": "OPEN", "crn": "44981", "subject": "CSCI", "course_num": "1012", "section": "31", "title": "Introduction to Programming with Python", "credits": "0.00", "instructor": "Goldfrank, J", "days": "W", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "4040", "course_number": "CSCI 1012"}, {"status": "OPEN", "crn": "44982", "subject": "CSCI", "course_num": "1012", "section": "32", "title": "Introduction to Programming with Python", "credits": "0.00", "instructor": "Goldfrank, J", "days": "F", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "4040", "course_number": "CSCI 1012"}, {"status": "OPEN", "crn": "44983", "subject": "CSCI", "course_num": "1012", "section": "33", "title": "Introduction to Programming with Python", "credits": "0.00", "instructor": "Goldfrank, J", "days": "F", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "MON", "room": "350", "course_number": "CSCI 1012"}, {"status": "OPEN", "crn": "44984", "subject": "CSCI", "course_num": "1012", "section": "34", "title": "Introduction to Programming with Python", "credits": "0.00", "instructor": "Goldfrank, J", "days": "W", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "1776 G", "room": "C-118", "course_number": "CSCI 1012"}, {"status": "OPEN", "crn": "44985", "subject": "CSCI", "course_num": "1012", "section": "35", "title": "Introduction to Programming with Python", "credits": "0.00", "instructor": "Goldfrank, J", "days": "W", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "DUQUES", "room": "250", "course_number": "CSCI 1012"}, {"status": "OPEN", "crn": "44986", "subject": "CSCI", "course_num": "1012", "section": "36", "title": "Introduction to Programming with Python", "credits": "0.00", "instructor": "Goldfrank, J", "days": "F", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "DUQUES", "room": "361", "course_number": "CSCI 1012"}, {"status": "WAITLIST", "crn": "45254", "subject": "CSCI", "course_num": "1012", "section": "37", "title": "Introduction to Programming with Python", "credits": "0.00", "instructor": "Goldfrank, J", "days": "F", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "Not specified", "room": "Not specified", "course_number": "CSCI 1012"}, {"status": "OPEN", "crn": "46084", "subject": "CSCI", "course_num": "1012", "section": "12", "title": "Introduction to Programming with Python", "credits": "3.00", "instructor": "Shaban, H", "days": "M", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "1957 E", "room": "212", "course_number": "CSCI 1012"}, {"status": "OPEN", "crn": "43428", "subject": "CSCI", "course_num": "1022", "section": "10", "title": "Introduction to Internet Technology", "credits": "3.00", "instructor": "Vidrine, E", "days": "R", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "301", "course_number": "CSCI 1022"}, {"status": "OPEN", "crn": "43433", "subject": "CSCI", "course_num": "1023", "section": "10", "title": "Introduction to Web Software Development", "credits": "3.00", "instructor": "Brenner, N", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "406", "course_number": "CSCI 1023"}, {"status": "OPEN", "crn": "43685", "subject": "CSCI", "course_num": "1111", "section": "10", "title": "Introduction to Software Development", "credits": "3.00", "instructor": "Dobolyi, K", "days": "TR", "time": {"start": "11:10AM", "end": "12:25PM", "raw": "11:10AM - 12:25PM"}, "dates": "01/12/26 - 04/27/26", "building": "MPA", "room": "B07", "course_number": "CSCI 1111"}, {"status": "OPEN", "crn": "43686", "subject": "CSCI", "course_num": "1111", "section": "30", "title": "Laboratory", "credits": "0.00", "instructor": "Dobolyi, K", "days": "M", "time": {"start": "11:10AM", "end": "01:00PM", "raw": "11:10AM - 01:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "405", "course_number": "CSCI 1111"}, {"status": "OPEN", "crn": "44551", "subject": "CSCI", "course_num": "1111", "section": "31", "title": "Laboratory", "credits": "0.00", "instructor": "Dobolyi, K", "days": "R", "time": {"start": "06:10PM", "end": "08:00PM", "raw": "06:10PM - 08:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400", "course_number": "CSCI 1111"}, {"status": "OPEN", "crn": "45730", "subject": "CSCI", "course_num": "1111", "section": "33", "title": "Laboratory", "credits": "0.00", "instructor": "Dobolyi, K", "days": "R", "time": {"start": "06:10PM", "end": "08:00PM", "raw": "06:10PM - 08:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1450", "course_number": "CSCI 1111"}, {"status": "OPEN", "crn": "43486", "subject": "CSCI", "course_num": "1112", "section": "10", "title": "Algorithms and Data Structures", "credits": "3.00", "instructor": "Taylor, J", "days": "TR", "time": {"start": "09:35AM", "end": "10:50AM", "raw": "09:35AM - 10:50AM"}, "dates": "01/12/26 - 04/27/26", "building": "Not specified", "room": "Not specified", "course_number": "CSCI 1112"}, {"status": "OPEN", "crn": "43487", "subject": "CSCI", "course_num": "1112", "section": "30", "title": "Laboratory", "credits": "0.00", "instructor": "Taylor, J", "days": "F", "time": {"start": "01:00PM", "end": "02:50PM", "raw": "01:00PM - 02:50PM"}, "dates": "01/12/26 - 04/27/26", "building": "GELM", "room": "641", "course_number": "CSCI 1112"}, {"status": "OPEN", "crn": "43488", "subject": "CSCI", "course_num": "1112", "section": "31", "title": "Laboratory", "credits": "0.00", "instructor": "Taylor, J", "days": "F", "time": {"start": "10:40AM", "end": "12:30PM", "raw": "10:40AM - 12:30PM"}, "dates": "01/12/26 - 04/27/26", "building": "MON", "room": "B33", "course_number": "CSCI 1112"}, {"status": "OPEN", "crn": "44549", "subject": "CSCI", "course_num": "1112", "section": "32", "title": "Laboratory", "credits": "0.00", "instructor": "Taylor, J", "days": "F", "time": {"start": "01:00PM", "end": "02:50PM", "raw": "01:00PM - 02:50PM"}, "dates": "01/12/26 - 04/27/26", "building": "1776 G", "room": "C-119", "course_number": "CSCI 1112"}, {"status": "OPEN", "crn": "44761", "subject": "CSCI", "course_num": "1112", "section": "33", "title": "Laboratory", "credits": "0.00", "instructor": "Taylor, J", "days": "F", "time": {"start": "10:40AM", "end": "12:30PM", "raw": "10:40AM - 12:30PM"}, "dates": "01/12/26 - 04/27/26", "building": "ROME", "room": "201", "course_number": "CSCI 1112"}, {"status": "OPEN", "crn": "43374", "subject": "CSCI", "course_num": "1311", "section": "10", "title": "Discrete Structures I", "credits": "3.00", "instructor": "", "days": "TR", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "PHIL", "room": "B156", "course_number": "CSCI 1311"}, {"status": "OPEN", "crn": "43799", "subject": "CSCI", "course_num": "1311", "section": "30", "title": "Laboratory", "credits": "0.00", "instructor": "", "days": "M", "time": {"start": "11:10AM", "end": "12:00PM", "raw": "11:10AM - 12:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "201", "course_number": "CSCI 1311"}, {"status": "OPEN", "crn": "43802", "subject": "CSCI", "course_num": "1311", "section": "31", "title": "Laboratory", "credits": "0.00", "instructor": "", "days": "M", "time": {"start": "02:20PM", "end": "03:10PM", "raw": "02:20PM - 03:10PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "402", "course_number": "CSCI 1311"}, {"status": "OPEN", "crn": "44550", "subject": "CSCI", "course_num": "1311", "section": "32", "title": "Laboratory", "credits": "0.00", "instructor": "", "days": "M", "time": {"start": "02:20PM", "end": "03:10PM", "raw": "02:20PM - 03:10PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400", "course_number": "CSCI 1311"}, {"status": "OPEN", "crn": "45148", "subject": "CSCI", "course_num": "1311", "section": "33", "title": "Laboratory", "credits": "0.00", "instructor": "", "days": "M", "time": {"start": "11:10AM", "end": "12:00PM", "raw": "11:10AM - 12:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "402", "course_number": "CSCI 1311"}, {"status": "OPEN", "crn": "43517", "subject": "CSCI", "course_num": "2113", "section": "10", "title": "Software Engineering", "credits": "3.00", "instructor": "Dobolyi, K", "days": "M", "time": {"start": "10:00AM", "end": "12:30PM", "raw": "10:00AM - 12:30PM"}, "dates": "01/12/26 - 04/27/26", "building": "FNGR", "room": "221", "course_number": "CSCI 2113"}, {"status": "OPEN", "crn": "43518", "subject": "CSCI", "course_num": "2113", "section": "30", "title": "Laboratory", "credits": "0.00", "instructor": "Dobolyi, K", "days": "W", "time": {"start": "11:10AM", "end": "12:25PM", "raw": "11:10AM - 12:25PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "405", "course_number": "CSCI 2113"}, {"status": "OPEN", "crn": "45393", "subject": "CSCI", "course_num": "2113", "section": "31", "title": "Laboratory", "credits": "0.00", "instructor": "Dobolyi, K", "days": "W", "time": {"start": "11:10AM", "end": "12:25PM", "raw": "11:10AM - 12:25PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "4040", "course_number": "CSCI 2113"}, {"status": "OPEN", "crn": "45137", "subject": "CSCI", "course_num": "2441W", "section": "10", "title": "Database Systems and Team Projects", "credits": "3.00", "instructor": "Parmer, G", "days": "W", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "310", "course_number": "CSCI 2441W"}, {"status": "OPEN", "crn": "45138", "subject": "CSCI", "course_num": "2441W", "section": "30", "title": "Laboratory", "credits": "0.00", "instructor": "Parmer, G", "days": "R", "time": {"start": "12:45PM", "end": "02:35PM", "raw": "12:45PM - 02:35PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "405", "course_number": "CSCI 2441W"}, {"status": "OPEN", "crn": "45586", "subject": "CSCI", "course_num": "2460", "section": "10", "title": "Introduction to Computer Systems", "credits": "3.00", "instructor": "He, L", "days": "R", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "1776 G", "room": "C-119", "course_number": "CSCI 2460"}, {"status": "OPEN", "crn": "44754", "subject": "CSCI", "course_num": "2541W", "section": "10", "title": "Database Systems and Team Projects", "credits": "3.00", "instructor": "He, L", "days": "MW", "time": {"start": "12:45PM", "end": "02:00PM", "raw": "12:45PM - 02:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400AND1450", "course_number": "CSCI 2541W"}, {"status": "OPEN", "crn": "44755", "subject": "CSCI", "course_num": "2541W", "section": "30", "title": "Laboratory", "credits": "0.00", "instructor": "He, L", "days": "W", "time": {"start": "02:10PM", "end": "03:25PM", "raw": "02:10PM - 03:25PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400", "course_number": "CSCI 2541W"}, {"status": "OPEN", "crn": "44756", "subject": "CSCI", "course_num": "2541W", "section": "31", "title": "Laboratory", "credits": "0.00", "instructor": "He, L", "days": "W", "time": {"start": "02:10PM", "end": "03:25PM", "raw": "02:10PM - 03:25PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1450", "course_number": "CSCI 2541W"}, {"status": "OPEN", "crn": "46085", "subject": "CSCI", "course_num": "3212", "section": "10", "title": "Algorithms", "credits": "4.00", "instructor": "Simha, R", "days": "TR", "time": {"start": "04:40PM", "end": "06:00PM", "raw": "04:40PM - 06:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400", "course_number": "CSCI 3212"}, {"status": "OPEN", "crn": "46086", "subject": "CSCI", "course_num": "3212", "section": "30", "title": "Algorithms Lab", "credits": "0.00", "instructor": "Simha, R", "days": "M", "time": {"start": "01:10PM", "end": "03:30PM", "raw": "01:10PM - 03:30PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "405", "course_number": "CSCI 3212"}, {"status": "OPEN", "crn": "45339", "subject": "CSCI", "course_num": "3313", "section": "10", "title": "Foundations of Computing", "credits": "3.00", "instructor": "Hwa, R", "days": "TR", "time": {"start": "11:10AM", "end": "12:25PM", "raw": "11:10AM - 12:25PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400AND1450", "course_number": "CSCI 3313"}, {"status": "OPEN", "crn": "45331", "subject": "CSCI", "course_num": "3313", "section": "30", "title": "Foundations of Computing", "credits": "0.00", "instructor": "Hwa, R", "days": "W", "time": {"start": "10:00AM", "end": "11:15AM", "raw": "10:00AM - 11:15AM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400", "course_number": "CSCI 3313"}, {"status": "OPEN", "crn": "45332", "subject": "CSCI", "course_num": "3313", "section": "31", "title": "Foundations of Computing", "credits": "0.00", "instructor": "Hwa, R", "days": "W", "time": {"start": "10:00AM", "end": "11:15AM", "raw": "10:00AM - 11:15AM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1450", "course_number": "CSCI 3313"}, {"status": "OPEN", "crn": "45843", "subject": "CSCI", "course_num": "3313", "section": "32", "title": "Foundations of Computing", "credits": "0.00", "instructor": "Hwa, R", "days": "W", "time": {"start": "11:15AM", "end": "12:30PM", "raw": "11:15AM - 12:30PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1450", "course_number": "CSCI 3313"}, {"status": "OPEN", "crn": "46358", "subject": "CSCI", "course_num": "3401", "section": "10", "title": "Computer Architecture and Organization", "credits": "3.00", "instructor": "Taylor, J", "days": "TR", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "GELM", "room": "B108", "course_number": "CSCI 3401"}, {"status": "OPEN", "crn": "46359", "subject": "CSCI", "course_num": "3401", "section": "30", "title": "Laboratory", "credits": "0.00", "instructor": "Taylor, J", "days": "M", "time": {"start": "10:00AM", "end": "11:15AM", "raw": "10:00AM - 11:15AM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400", "course_number": "CSCI 3401"}, {"status": "OPEN", "crn": "46360", "subject": "CSCI", "course_num": "3401", "section": "31", "title": "Laboratory", "credits": "0.00", "instructor": "Taylor, J", "days": "M", "time": {"start": "10:00AM", "end": "11:15AM", "raw": "10:00AM - 11:15AM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1450", "course_number": "CSCI 3401"}, {"status": "OPEN", "crn": "46125", "subject": "CSCI", "course_num": "4237", "section": "10", "title": "Software Design for Handheld Devices", "credits": "3.00", "instructor": "Cobb, M", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "402", "course_number": "CSCI 4237"}, {"status": "OPEN", "crn": "43876", "subject": "CSCI", "course_num": "4244", "section": "10", "title": "Capstone Design Project II", "credits": "4.00", "instructor": "Kim, T", "days": "T", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "MON", "room": "B32", "course_number": "CSCI 4244"}, {"status": "OPEN", "crn": "43943", "subject": "CSCI", "course_num": "4244", "section": "30", "title": "Laboratory", "credits": "0.00", "instructor": "Kim, T; Qu, X", "days": "W", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400", "course_number": "CSCI 4244"}, {"status": "OPEN", "crn": "44901", "subject": "CSCI", "course_num": "4244", "section": "31", "title": "Capstone Design Project II", "credits": "0.00", "instructor": "Shapiro, J; Qu, X", "days": "W", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1450", "course_number": "CSCI 4244"}, {"status": "OPEN", "crn": "45584", "subject": "CSCI", "course_num": "4244", "section": "11", "title": "Capstone Design Project II", "credits": "4.00", "instructor": "Shapiro, J", "days": "T", "time": {"start": "03:45PM", "end": "05:00PM", "raw": "03:45PM - 05:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "201", "course_number": "CSCI 4244"}, {"status": "OPEN", "crn": "47498", "subject": "CSCI", "course_num": "4364", "section": "10", "title": "Machine Learning", "credits": "3.00", "instructor": "Qu, X", "days": "F", "time": {"start": "09:30AM", "end": "12:00PM", "raw": "09:30AM - 12:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "1957 E", "room": "B17", "course_number": "CSCI 4364"}, {"status": "OPEN", "crn": "45732", "subject": "CSCI", "course_num": "4364", "section": "81", "title": "Machine Learning", "credits": "3.00", "instructor": "Feng, S", "days": "R", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "COR", "room": "104", "course_number": "CSCI 4364"}, {"status": "OPEN", "crn": "45733", "subject": "CSCI", "course_num": "6364", "section": "81", "title": "Machine Learning", "credits": "3.00", "instructor": "Feng, S", "days": "R", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "COR", "room": "104", "course_number": "CSCI 6364"}, {"status": "OPEN", "crn": "46510", "subject": "CSCI", "course_num": "4366", "section": "80", "title": "Neural Networks and Deep Learning", "credits": "3.00", "instructor": "Sipple, J", "days": "M", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400", "course_number": "CSCI 4366"}, {"status": "OPEN", "crn": "46517", "subject": "CSCI", "course_num": "6366", "section": "80", "title": "Neural Networks and Deep Learning", "credits": "3.00", "instructor": "Sipple, J", "days": "M", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1300AND1400", "course_number": "CSCI 6366"}, {"status": "OPEN", "crn": "45135", "subject": "CSCI", "course_num": "4455", "section": "10", "title": "Computer Game Design and Programming", "credits": "3.00", "instructor": "Byun, J", "days": "M", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "MPA", "room": "208", "course_number": "CSCI 4455"}, {"status": "OPEN", "crn": "47351", "subject": "CSCI", "course_num": "4511", "section": "80", "title": "Artificial Intelligence", "credits": "3.00", "instructor": "Goldfrank, J", "days": "F", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "GELM", "room": "B108", "course_number": "CSCI 4511"}, {"status": "OPEN", "crn": "45328", "subject": "CSCI", "course_num": "6511", "section": "80", "title": "Artificial Intelligence", "credits": "3.00", "instructor": "Goldfrank, J", "days": "F", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "GELM", "room": "B108", "course_number": "CSCI 6511"}, {"status": "OPEN", "crn": "44197", "subject": "CSCI", "course_num": "4531", "section": "80", "title": "Computer Security", "credits": "3.00", "instructor": "Zhou, J", "days": "W", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "FNGR", "room": "220", "course_number": "CSCI 4531"}, {"status": "OPEN", "crn": "44159", "subject": "CSCI", "course_num": "6531", "section": "80", "title": "Computer Security", "credits": "3.00", "instructor": "Zhou, J", "days": "W", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "FNGR", "room": "220", "course_number": "CSCI 6531"}, {"status": "OPEN", "crn": "43549", "subject": "CSCI", "course_num": "4541", "section": "80", "title": "Network Security", "credits": "3.00", "instructor": "Refaei, M", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "Not specified", "room": "Not specified", "course_number": "CSCI 4541"}, {"status": "OPEN", "crn": "43553", "subject": "CSCI", "course_num": "6541", "section": "80", "title": "Network Security", "credits": "3.00", "instructor": "Refaei, M", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "Not specified", "room": "Not specified", "course_number": "CSCI 6541"}, {"status": "OPEN", "crn": "44270", "subject": "CSCI", "course_num": "4554", "section": "10", "title": "Computer Graphics I", "credits": "3.00", "instructor": "Adhami, L", "days": "M", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "COR", "room": "204", "course_number": "CSCI 4554"}, {"status": "OPEN", "crn": "47433", "subject": "CSCI", "course_num": "4907", "section": "10", "title": "Advanced Topics in AR", "credits": "3.00", "instructor": "Ok, H", "days": "W", "time": {"start": "03:30PM", "end": "06:00PM", "raw": "03:30PM - 06:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "411", "course_number": "CSCI 4907"}, {"status": "OPEN", "crn": "47434", "subject": "CSCI", "course_num": "6907", "section": "10", "title": "Advanced Topics in AR", "credits": "3.00", "instructor": "Ok, H", "days": "W", "time": {"start": "03:30PM", "end": "06:00PM", "raw": "03:30PM - 06:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "411", "course_number": "CSCI 6907"}, {"status": "OPEN", "crn": "47499", "subject": "CSCI", "course_num": "4907", "section": "11", "title": "Advanced Topics in Computer Science", "credits": "3.00", "instructor": "Mehrabian, A; Hamidian, S", "days": "F", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "307", "course_number": "CSCI 4907"}, {"status": "OPEN", "crn": "46511", "subject": "CSCI", "course_num": "4907", "section": "81", "title": "Cloud Computing", "credits": "3.00", "instructor": "Fernandez, R", "days": "F", "time": {"start": "07:10PM", "end": "09:40PM", "raw": "07:10PM - 09:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "Not specified", "room": "Not specified", "course_number": "CSCI 4907"}, {"status": "OPEN", "crn": "46515", "subject": "CSCI", "course_num": "6907", "section": "81", "title": "Cloud Computing", "credits": "3.00", "instructor": "Fernandez, R", "days": "F", "time": {"start": "07:10PM", "end": "09:40PM", "raw": "07:10PM - 09:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "Not specified", "room": "Not specified", "course_number": "CSCI 6907"}, {"status": "OPEN", "crn": "46512", "subject": "CSCI", "course_num": "4907", "section": "82", "title": "Natural Language Understanding", "credits": "3.00", "instructor": "Kurdi Zirikly, A", "days": "T", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "1957 E", "room": "111", "course_number": "CSCI 4907"}, {"status": "OPEN", "crn": "46357", "subject": "CSCI", "course_num": "4907", "section": "84", "title": "Data Mgt Sys for DataAnalytics", "credits": "3.00", "instructor": "Mendenhall, A", "days": "M", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1450", "course_number": "CSCI 4907"}, {"status": "OPEN", "crn": "45333", "subject": "CSCI", "course_num": "6586", "section": "80", "title": "Data Management Systems for Data Analytics", "credits": "3.00", "instructor": "Mendenhall, A", "days": "M", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1450", "course_number": "CSCI 6586"}, {"status": "OPEN", "crn": "45334", "subject": "CSCI", "course_num": "6907", "section": "83", "title": "Data Mgt Sys for DataAnalytics", "credits": "3.00", "instructor": "Mendenhall, A", "days": "M", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "1450", "course_number": "CSCI 6907"}, {"status": "OPEN", "crn": "46595", "subject": "CSCI", "course_num": "4907", "section": "85", "title": "Big Data & Analytics", "credits": "3.00", "instructor": "Omrani Sabbaghi, S", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "1776 G", "room": "C-103", "course_number": "CSCI 4907"}, {"status": "OPEN", "crn": "46596", "subject": "CSCI", "course_num": "6444", "section": "85", "title": "Introduction to Big Data and Analytics", "credits": "3.00", "instructor": "Omrani Sabbaghi, S", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "1776 G", "room": "C-103", "course_number": "CSCI 6444"}, {"status": "OPEN", "crn": "46547", "subject": "CSCI", "course_num": "4907", "section": "86", "title": "Design of Autonomous Systems", "credits": "3.00", "instructor": "Mohan, S", "days": "TR", "time": {"start": "12:45PM", "end": "02:00PM", "raw": "12:45PM - 02:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "GELM", "room": "642ANDB103", "course_number": "CSCI 4907"}, {"status": "OPEN", "crn": "46548", "subject": "CSCI", "course_num": "6907", "section": "86", "title": "Design of Autonomous Systems", "credits": "3.00", "instructor": "Mohan, S", "days": "TR", "time": {"start": "12:45PM", "end": "02:00PM", "raw": "12:45PM - 02:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "GELM", "room": "642ANDB103", "course_number": "CSCI 6907"}, {"status": "OPEN", "crn": "45095", "subject": "CSCI", "course_num": "6212", "section": "10", "title": "Design and Analysis of Algorithms", "credits": "3.00", "instructor": "Youssef, A", "days": "M", "time": {"start": "03:30PM", "end": "06:00PM", "raw": "03:30PM - 06:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "GELM", "room": "B108ANDFNGR220", "course_number": "CSCI 6212"}, {"status": "OPEN", "crn": "46178", "subject": "CSCI", "course_num": "6221", "section": "10", "title": "Advanced Software Paradigms", "credits": "3.00", "instructor": "Hwang, Y", "days": "W", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "MON", "room": "B33", "course_number": "CSCI 6221"}, {"status": "OPEN", "crn": "45577", "subject": "CSCI", "course_num": "6231", "section": "10", "title": "Software Engineering", "credits": "3.00", "instructor": "McKeeby, J", "days": "M", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "405", "course_number": "CSCI 6231"}, {"status": "OPEN", "crn": "43375", "subject": "CSCI", "course_num": "6234", "section": "10", "title": "Object-Oriented Design", "credits": "3.00", "instructor": "Melo, W", "days": "R", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "GELM", "room": "B108", "course_number": "CSCI 6234"}, {"status": "OPEN", "crn": "46124", "subject": "CSCI", "course_num": "6235", "section": "10", "title": "Component-Based Enterprise Software Development", "credits": "3.00", "instructor": "Levy, R", "days": "F", "time": {"start": "03:30PM", "end": "06:00PM", "raw": "03:30PM - 06:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "MPA", "room": "302", "course_number": "CSCI 6235"}, {"status": "OPEN", "crn": "47489", "subject": "CSCI", "course_num": "6364", "section": "10", "title": "Machine Learning", "credits": "3.00", "instructor": "Mehrabian, A", "days": "F", "time": {"start": "09:30AM", "end": "12:00PM", "raw": "09:30AM - 12:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "PHIL", "room": "B152", "course_number": "CSCI 6364"}, {"status": "OPEN", "crn": "47490", "subject": "CSCI", "course_num": "6365", "section": "10", "title": "Advanced Machine Learning", "credits": "3.00", "instructor": "Hamidian, S; Mehrabian, A", "days": "F", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "TOMP", "room": "309", "course_number": "CSCI 6365"}, {"status": "OPEN", "crn": "46087", "subject": "CSCI", "course_num": "6418", "section": "80", "title": "Linux for scientists, engineers, & computational science.", "credits": "3.00", "instructor": "Salimi, B", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "ROME", "room": "201", "course_number": "CSCI 6418"}, {"status": "OPEN", "crn": "41729", "subject": "CSCI", "course_num": "6418", "section": "DE", "title": "Unix Systems Administration", "credits": "3.00", "instructor": "Salimi, B", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "ON", "room": "LINE", "course_number": "CSCI 6418"}, {"status": "OPEN", "crn": "46133", "subject": "CSCI", "course_num": "6421", "section": "80", "title": "Distributed and Cluster Computing", "credits": "3.00", "instructor": "Haghnazar Koochaksaraei, R", "days": "R", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "MON", "room": "251", "course_number": "CSCI 6421"}, {"status": "OPEN", "crn": "46132", "subject": "CSCI", "course_num": "6421", "section": "81", "title": "Distributed and Cluster Computing", "credits": "3.00", "instructor": "Haghnazar Koochaksaraei, R", "days": "R", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "MON", "room": "251", "course_number": "CSCI 6421"}, {"status": "OPEN", "crn": "45376", "subject": "CSCI", "course_num": "6442", "section": "10", "title": "Database Systems II", "credits": "3.00", "instructor": "Fernandez, R", "days": "R", "time": {"start": "07:10PM", "end": "09:40PM", "raw": "07:10PM - 09:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "MPA", "room": "B07", "course_number": "CSCI 6442"}, {"status": "OPEN", "crn": "46158", "subject": "CSCI", "course_num": "6443", "section": "10", "title": "Data Mining", "credits": "3.00", "instructor": "Bellaachia, A", "days": "R", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "ROME", "room": "459", "course_number": "CSCI 6443"}, {"status": "OPEN", "crn": "45410", "subject": "CSCI", "course_num": "6461", "section": "10", "title": "Computer System Architecture", "credits": "3.00", "instructor": "Narahari, B", "days": "TR", "time": {"start": "02:20PM", "end": "03:35PM", "raw": "02:20PM - 03:35PM"}, "dates": "01/12/26 - 04/27/26", "building": "PHIL", "room": "111", "course_number": "CSCI 6461"}, {"status": "OPEN", "crn": "46177", "subject": "CSCI", "course_num": "6461", "section": "12", "title": "Computer System Architecture", "credits": "3.00", "instructor": "Lancaster, M", "days": "R", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "1957 E", "room": "214", "course_number": "CSCI 6461"}, {"status": "OPEN", "crn": "43944", "subject": "CSCI", "course_num": "6534", "section": "10", "title": "Information Security in Government", "credits": "1.00 TO   3.00", "instructor": "Kelly, P", "days": "W", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "MON", "room": "252", "course_number": "CSCI 6534"}, {"status": "OPEN", "crn": "45794", "subject": "CSCI", "course_num": "6542", "section": "10", "title": "Computer Network Defense", "credits": "3.00", "instructor": "Yasuda, K; Norris, M", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "4040", "course_number": "CSCI 6542"}, {"status": "OPEN", "crn": "44785", "subject": "CSCI", "course_num": "6548", "section": "10", "title": "E-Commerce Security", "credits": "3.00", "instructor": "Ok, H", "days": "R", "time": {"start": "03:30PM", "end": "06:00PM", "raw": "03:30PM - 06:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "MON", "room": "114", "course_number": "CSCI 6548"}, {"status": "OPEN", "crn": "45734", "subject": "CSCI", "course_num": "6554", "section": "10", "title": "Computer Graphics II", "credits": "3.00", "instructor": "Hahn, J", "days": "R", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "DUQUES", "room": "361", "course_number": "CSCI 6554"}, {"status": "OPEN", "crn": "45735", "subject": "CSCI", "course_num": "6562", "section": "80", "title": "Design of Interactive Multimedia", "credits": "3.00", "instructor": "Nicolas, E", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "PHIL", "room": "109", "course_number": "CSCI 6562"}, {"status": "OPEN", "crn": "45736", "subject": "CSCI", "course_num": "6562", "section": "81", "title": "Design of Interactive Multimedia", "credits": "3.00", "instructor": "Nicolas, E", "days": "T", "time": {"start": "06:10PM", "end": "08:40PM", "raw": "06:10PM - 08:40PM"}, "dates": "01/12/26 - 04/27/26", "building": "PHIL", "room": "109", "course_number": "CSCI 6562"}, {"status": "OPEN", "crn": "47382", "subject": "CSCI", "course_num": "6907", "section": "87", "title": "Robotics Vision and Perception", "credits": "3.00", "instructor": "Lee, T", "days": "F", "time": {"start": "10:00AM", "end": "12:30PM", "raw": "10:00AM - 12:30PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "3040", "course_number": "CSCI 6907"}, {"status": "OPEN", "crn": "46539", "subject": "CSCI", "course_num": "6292", "section": "80", "title": "Robotics Vision and Perception", "credits": "3.00", "instructor": "Lee, T", "days": "F", "time": {"start": "10:00AM", "end": "12:30PM", "raw": "10:00AM - 12:30PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "3040", "course_number": "CSCI 6292"}, {"status": "OPEN", "crn": "47440", "subject": "CSCI", "course_num": "6907", "section": "88", "title": "Trustworthy AI", "credits": "3.00", "instructor": "Pless, R; Szajnfarber, Z", "days": "M", "time": {"start": "03:30PM", "end": "06:00PM", "raw": "03:30PM - 06:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "B1220", "course_number": "CSCI 6907"}, {"status": "OPEN", "crn": "45887", "subject": "CSCI", "course_num": "6992", "section": "81", "title": "Trustworthy AI", "credits": "3.00", "instructor": "Pless, R; Szajnfarber, Z", "days": "M", "time": {"start": "03:30PM", "end": "06:00PM", "raw": "03:30PM - 06:00PM"}, "dates": "01/12/26 - 04/27/26", "building": "SEH", "room": "B1220", "course_number": "CSCI 6992"}, {"status": "OPEN", "crn": "45885", "subject": "CSCI", "course_num": "8901", "section": "80", "title": "Research and Evaluation Methods", "credits": "3.00", "instructor": "Wood, T; Broniatowski, D", "days": "R", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "MON", "room": "352", "course_number": "CSCI 8901"}, {"status": "OPEN", "crn": "45357", "subject": "CSCI", "course_num": "8000", "section": "80", "title": "Research Formulation in Engineering Management and Systems Engineering", "credits": "3.00", "instructor": "Broniatowski, D; Wood, T", "days": "R", "time": {"start": "12:45PM", "end": "03:15PM", "raw": "12:45PM - 03:15PM"}, "dates": "01/12/26 - 04/27/26", "building": "Not specified", "room": "Not specified", "course_number": "CSCI 8000"}];
        const dayMap = { 'M': 'monday', 'T': 'tuesday', 'W': 'wednesday', 'R': 'thursday', 'F': 'friday' };
        let instructorColors = {};
        let selectedInstructors = new Set();
        let activeTab = 'all-courses';
        let selectedDay = null;
        let roomConflicts = [];
        let levelFilter = 'all';

        // Edit mode variables
        let editedCourses = JSON.parse(JSON.stringify(courses)); // Deep copy for editing
        let editCount = 0;
        let editedCRNs = new Set();
        let ignoredConflicts = new Set(JSON.parse(localStorage.getItem('ignoredConflicts') || '[]'));
        let editIgnoredConflicts = new Set(JSON.parse(localStorage.getItem('editIgnoredConflicts') || '[]'));
        let currentEditCRN = null;
        let editSelectedInstructors = new Set();
        let editRoomFilter = 'all';
        let editLevelFilter = 'all';
        let isImporting = false; // Flag to prevent multiple renders during import

        // Generate unique color for each instructor using HSL
        function generateInstructorColors() {
            const instructors = [...new Set(courses.map(c => c.instructor))].sort();
            const hueStep = 360 / instructors.length;
            instructors.forEach((instructor, index) => {
                const hue = Math.floor(index * hueStep);
                const saturation = 65 + (index % 3) * 10; // 65%, 75%, or 85%
                const lightness = 50 + (index % 2) * 10;  // 50% or 60%
                instructorColors[instructor] = `hsl(${hue}, ${saturation}%, ${lightness}%)`;
            });
        }

        function getInstructorColor(instructor) {
            return instructorColors[instructor] || '#667eea';
        }

        // Tab switching
        function switchTab(tabName) {
            activeTab = tabName;

            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.getAttribute('data-tab') === tabName) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // Update tab content visibility
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
            });
            document.getElementById(tabName + '-tab').style.display = 'block';

            // Show/hide main calendar filters (hide in edit mode, show otherwise)
            const mainFilters = document.getElementById('mainCalendarFilters');
            if (mainFilters) {
                mainFilters.style.display = tabName === 'edit-schedule' ? 'none' : 'flex';
            }

            // Load tab-specific content
            if (tabName === 'planning-mode') {
                generatePlanningMode();
            } else if (tabName === 'room-conflicts') {
                detectAndDisplayRoomConflicts();
            } else if (tabName === 'edit-schedule') {
                initializeEditMode();
            }
        }

        function timeToMinutes(timeStr) {
            const match = timeStr.match(/(\d{1,2}):(\d{2})([AP]M)/);
            if (!match) {
                console.error('timeToMinutes: Failed to parse time string:', timeStr);
                return 0;
            }
            let hours = parseInt(match[1]);
            const minutes = parseInt(match[2]);
            const period = match[3];
            if (period === 'PM' && hours !== 12) hours += 12;
            if (period === 'AM' && hours === 12) hours = 0;
            const result = hours * 60 + minutes;

            // Debug log for any imported course times
            if (timeStr === '11:00AM' || timeStr === '12:50PM' || timeStr === '09:00AM' || timeStr === '10:50AM') {
                console.log(`timeToMinutes('${timeStr}') = ${result} (hours=${hours}, minutes=${minutes}, period=${period})`);
            }

            return result;
        }

        // Helper function to extract course level and determine if grad/undergrad
        function getCourseLevel(courseNumber) {
            // Extract the numeric part from course_number (e.g., "GEOG 1001" -> 1001)
            const match = courseNumber.match(/\d+/);
            if (!match) return 0;
            const level = parseInt(match[0]);
            return level;
        }

        function isGraduateCourse(courseNumber) {
            const level = getCourseLevel(courseNumber);
            return level >= 6000;
        }

        function createTimeSlots() {
            const timeColumn = document.getElementById('timeColumn');
            const startHour = 9;
            const endHour = 21;
            for (let hour = startHour; hour <= endHour; hour++) {
                const timeSlot = document.createElement('div');
                timeSlot.className = 'time-slot';
                const displayHour = hour > 12 ? hour - 12 : (hour === 0 ? 12 : hour);
                const period = hour >= 12 ? 'PM' : 'AM';
                timeSlot.textContent = `${displayHour}:00 ${period}`;
                timeColumn.appendChild(timeSlot);
            }
            ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'].forEach(day => {
                const dayColumn = document.getElementById(day);
                for (let i = 0; i <= endHour - startHour; i++) {
                    const line = document.createElement('div');
                    line.className = 'hour-line';
                    line.style.top = `${i * 60}px`;
                    dayColumn.appendChild(line);
                }
            });
        }

        function renderCourses() {
            const startHour = 9;
            const pixelsPerMinute = 1;
            document.getElementById('totalCourses').textContent = courses.length;
            const instructors = new Set(courses.map(c => c.instructor));
            document.getElementById('totalInstructors').textContent = instructors.size;
            const coursesByDay = { monday: [], tuesday: [], wednesday: [], thursday: [], friday: [] };
            courses.forEach(course => {
                course.days.split('').forEach(day => {
                    const dayId = dayMap[day];
                    if (dayId) coursesByDay[dayId].push(course);
                });
            });
            Object.keys(coursesByDay).forEach(dayId => {
                const dayColumn = document.getElementById(dayId);
                const coursesForDay = coursesByDay[dayId];
                coursesForDay.sort((a, b) => timeToMinutes(a.time.start) - timeToMinutes(b.time.start));
                const processed = new Set();
                coursesForDay.forEach((course, index) => {
                    if (processed.has(index)) return;
                    const startMinutes = timeToMinutes(course.time.start);
                    const endMinutes = timeToMinutes(course.time.end);
                    const duration = endMinutes - startMinutes;
                    const topPosition = (startMinutes - (startHour * 60)) * pixelsPerMinute;
                    const height = duration * pixelsPerMinute;
                    const overlapping = [];
                    for (let i = index + 1; i < coursesForDay.length; i++) {
                        if (processed.has(i)) continue;
                        const other = coursesForDay[i];
                        const otherStart = timeToMinutes(other.time.start);
                        const otherEnd = timeToMinutes(other.time.end);
                        if (startMinutes < otherEnd && endMinutes > otherStart) {
                            overlapping.push({course: other, index: i});
                        }
                    }
                    const totalOverlapping = overlapping.length + 1;
                    const widthPercent = 100 / totalOverlapping;
                    renderCourseBlock(course, dayColumn, topPosition, height, 0, widthPercent);
                    processed.add(index);
                    overlapping.forEach((item, i) => {
                        const otherStartMinutes = timeToMinutes(item.course.time.start);
                        const otherEndMinutes = timeToMinutes(item.course.time.end);
                        const otherDuration = otherEndMinutes - otherStartMinutes;
                        const otherTopPosition = (otherStartMinutes - (startHour * 60)) * pixelsPerMinute;
                        const otherHeight = otherDuration * pixelsPerMinute;
                        renderCourseBlock(item.course, dayColumn, otherTopPosition, otherHeight, i + 1, widthPercent);
                        processed.add(item.index);
                    });
                });
            });
        }

        function renderCourseBlock(course, dayColumn, topPosition, height, column, widthPercent) {
            const courseBlock = document.createElement('div');
            courseBlock.className = 'course-block';
            courseBlock.style.top = `${topPosition}px`;
            courseBlock.style.height = `${height}px`;
            courseBlock.style.left = `${column * widthPercent}%`;
            courseBlock.style.width = `calc(${widthPercent}% - 4px)`;

            // Use instructor-specific color
            const instructorColor = getInstructorColor(course.instructor);
            courseBlock.style.background = instructorColor;

            // Check if this course has a room conflict
            const hasConflict = roomConflicts.some(conflict =>
                conflict.courses.some(c => c.crn === course.crn)
            );
            if (hasConflict) {
                courseBlock.classList.add('conflict-indicator');
            }

            courseBlock.innerHTML = `
                <div class="course-number">${course.course_number}</div>
                <div class="course-name">${course.title}</div>
                <div class="course-time">${course.time.start}</div>
                <div class="tooltip">
                    <div class="tooltip-row"><span class="tooltip-label">Course:</span><span class="tooltip-value">${course.course_number}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">Instructor:</span><span class="tooltip-value">${course.instructor}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">Time:</span><span class="tooltip-value">${course.time.raw}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">Location:</span><span class="tooltip-value">${course.building} ${course.room}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">CRN:</span><span class="tooltip-value">${course.crn}</span></div>
                </div>
            `;
            courseBlock.onclick = () => showModal(course);
            dayColumn.appendChild(courseBlock);
        }

        function showModal(course) {
            const statusBadge = document.getElementById('statusBadge');
            const statusClass = course.status === 'OPEN' ? 'status-open' : 'status-closed';
            statusBadge.className = 'status-badge ' + statusClass;
            statusBadge.textContent = course.status;
            document.getElementById('modalCourseNumber').textContent = course.course_number;
            document.getElementById('modalCourseName').textContent = course.title;
            document.getElementById('modalCRN').textContent = course.crn;
            document.getElementById('modalInstructor').textContent = course.instructor;
            document.getElementById('modalTime').textContent = course.time.raw;
            document.getElementById('modalDays').textContent = expandDays(course.days);
            document.getElementById('modalBuilding').textContent = course.building;
            document.getElementById('modalRoom').textContent = course.room;
            document.getElementById('modalCredits').textContent = course.credits;
            document.getElementById('modalDates').textContent = course.dates;
            document.getElementById('modal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        function expandDays(days) {
            const dayNames = { 'M': 'Monday', 'T': 'Tuesday', 'W': 'Wednesday', 'R': 'Thursday', 'F': 'Friday' };
            return days.split('').map(d => dayNames[d]).join(', ');
        }

        // Instructor dropdown functions
        function populateInstructorList() {
            const instructors = [...new Set(courses.map(c => c.instructor))].sort();
            const instructorList = document.getElementById('instructorList');
            instructorList.innerHTML = '';

            instructors.forEach(instructor => {
                const item = document.createElement('div');
                item.className = 'instructor-checkbox-item';
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `instructor-${instructor.replace(/\s+/g, '-')}`;
                checkbox.value = instructor;
                checkbox.checked = selectedInstructors.size === 0 || selectedInstructors.has(instructor);
                checkbox.onchange = () => toggleInstructorSelection(instructor);

                const label = document.createElement('label');
                label.setAttribute('for', checkbox.id);
                const colorIndicator = document.createElement('span');
                colorIndicator.className = 'instructor-color-indicator';
                colorIndicator.style.backgroundColor = getInstructorColor(instructor);
                label.appendChild(colorIndicator);
                label.appendChild(document.createTextNode(instructor));

                item.appendChild(checkbox);
                item.appendChild(label);
                instructorList.appendChild(item);
            });
        }

        function toggleInstructorDropdown() {
            const dropdown = document.getElementById('instructorDropdown');
            dropdown.classList.toggle('show');
        }

        function toggleInstructorSelection(instructor) {
            if (selectedInstructors.has(instructor)) {
                selectedInstructors.delete(instructor);
            } else {
                selectedInstructors.add(instructor);
            }
            updateInstructorButtonText();
            applyFilters();
        }

        function selectAllInstructors() {
            selectedInstructors.clear();
            document.querySelectorAll('#instructorList input[type="checkbox"]').forEach(cb => {
                cb.checked = true;
            });
            updateInstructorButtonText();
            applyFilters();
        }

        function clearAllInstructors() {
            selectedInstructors.clear();
            document.querySelectorAll('#instructorList input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
                selectedInstructors.add(cb.value);
            });
            // Start with one instructor selected
            const firstCheckbox = document.querySelector('#instructorList input[type="checkbox"]');
            if (firstCheckbox) {
                firstCheckbox.checked = true;
                selectedInstructors.clear();
                selectedInstructors.add(firstCheckbox.value);
            }
            updateInstructorButtonText();
            applyFilters();
        }

        function updateInstructorButtonText() {
            const btnText = document.getElementById('instructorBtnText');
            if (selectedInstructors.size === 0) {
                btnText.textContent = 'All Instructors';
            } else if (selectedInstructors.size === 1) {
                btnText.textContent = Array.from(selectedInstructors)[0];
            } else {
                btnText.textContent = `${selectedInstructors.size} Instructors`;
            }
        }

        // Level filter dropdown functions
        function toggleLevelDropdown() {
            const dropdown = document.getElementById('levelDropdown');
            dropdown.classList.toggle('show');
        }

        function setLevelFilter(level) {
            levelFilter = level;
            const btnText = document.getElementById('levelBtnText');
            if (level === 'all') {
                btnText.textContent = 'All Levels';
            } else if (level === 'undergrad') {
                btnText.textContent = 'Undergrad';
            } else if (level === 'grad') {
                btnText.textContent = 'Grad';
            }
            document.getElementById('levelDropdown').classList.remove('show');
            applyFilters();
        }

        function applyFilters() {
            clearCalendar();
            const filteredCourses = courses.filter(course => {
                const instructorMatch = selectedInstructors.size === 0 || selectedInstructors.has(course.instructor);

                // Apply level filter
                let levelMatch = true;
                if (levelFilter === 'undergrad') {
                    levelMatch = !isGraduateCourse(course.course_number);
                } else if (levelFilter === 'grad') {
                    levelMatch = isGraduateCourse(course.course_number);
                }

                return instructorMatch && levelMatch;
            });
            renderCoursesFiltered(filteredCourses);
            updateFilterStatus();
            updateInstructorLegend();

            // If class list is active, regenerate it with the filtered instructors
            if (activeTab === 'planning-mode') {
                generatePlanningMode();
            }
        }

        function clearCalendar() {
            ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'].forEach(day => {
                const dayColumn = document.getElementById(day);
                // Remove only course blocks, keep hour lines
                dayColumn.querySelectorAll('.course-block').forEach(block => block.remove());
            });
        }

        function renderCoursesFiltered(coursesToRender) {
            const startHour = 9;
            const pixelsPerMinute = 1;
            const coursesByDay = { monday: [], tuesday: [], wednesday: [], thursday: [], friday: [] };

            coursesToRender.forEach(course => {
                course.days.split('').forEach(day => {
                    const dayId = dayMap[day];
                    if (dayId) coursesByDay[dayId].push(course);
                });
            });

            Object.keys(coursesByDay).forEach(dayId => {
                const dayColumn = document.getElementById(dayId);
                const coursesForDay = coursesByDay[dayId];
                coursesForDay.sort((a, b) => timeToMinutes(a.time.start) - timeToMinutes(b.time.start));
                const processed = new Set();

                coursesForDay.forEach((course, index) => {
                    if (processed.has(index)) return;
                    const startMinutes = timeToMinutes(course.time.start);
                    const endMinutes = timeToMinutes(course.time.end);
                    const duration = endMinutes - startMinutes;
                    const topPosition = (startMinutes - (startHour * 60)) * pixelsPerMinute;
                    const height = duration * pixelsPerMinute;
                    const overlapping = [];

                    for (let i = index + 1; i < coursesForDay.length; i++) {
                        if (processed.has(i)) continue;
                        const other = coursesForDay[i];
                        const otherStart = timeToMinutes(other.time.start);
                        const otherEnd = timeToMinutes(other.time.end);
                        if (startMinutes < otherEnd && endMinutes > otherStart) {
                            overlapping.push({course: other, index: i});
                        }
                    }

                    const totalOverlapping = overlapping.length + 1;
                    const widthPercent = 100 / totalOverlapping;
                    renderCourseBlock(course, dayColumn, topPosition, height, 0, widthPercent);
                    processed.add(index);

                    overlapping.forEach((item, i) => {
                        const otherStartMinutes = timeToMinutes(item.course.time.start);
                        const otherEndMinutes = timeToMinutes(item.course.time.end);
                        const otherDuration = otherEndMinutes - otherStartMinutes;
                        const otherTopPosition = (otherStartMinutes - (startHour * 60)) * pixelsPerMinute;
                        const otherHeight = otherDuration * pixelsPerMinute;
                        renderCourseBlock(item.course, dayColumn, otherTopPosition, otherHeight, i + 1, widthPercent);
                        processed.add(item.index);
                    });
                });
            });
        }

        function updateFilterStatus() {
            const filterStatus = document.getElementById('filterStatus');
            let statusParts = [];

            if (selectedDay) {
                const dayNames = {
                    'monday': 'Monday',
                    'tuesday': 'Tuesday',
                    'wednesday': 'Wednesday',
                    'thursday': 'Thursday',
                    'friday': 'Friday'
                };
                statusParts.push(`${dayNames[selectedDay]} only`);
            } else {
                statusParts.push('all days');
            }

            // Add level filter status
            if (levelFilter === 'undergrad') {
                statusParts.push('undergrad only');
            } else if (levelFilter === 'grad') {
                statusParts.push('grad only');
            } else {
                statusParts.push('all levels');
            }

            if (selectedInstructors.size === 0) {
                statusParts.push('all instructors');
            } else if (selectedInstructors.size === 1) {
                statusParts.push(Array.from(selectedInstructors)[0]);
            } else {
                statusParts.push(`${selectedInstructors.size} instructors`);
            }

            filterStatus.textContent = `Showing: ${statusParts.join(' | ')}`;
        }

        function updateInstructorLegend() {
            const legend = document.getElementById('instructorLegend');
            if (!legend) return;

            const instructorsToShow = selectedInstructors.size === 0
                ? [...new Set(courses.map(c => c.instructor))].sort()
                : Array.from(selectedInstructors).sort();

            let html = '<div class="legend-title">👥 Instructor Color Key</div><div class="legend-grid">';
            instructorsToShow.forEach(instructor => {
                const color = getInstructorColor(instructor);
                html += `<div class="legend-grid-item"><span class="color-box" style="background: ${color}"></span><span>${instructor}</span></div>`;
            });
            html += '</div>';
            legend.innerHTML = html;
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            // Close instructor dropdown
            const dropdown = document.getElementById('instructorDropdown');
            const btn = document.getElementById('instructorDropdownBtn');
            if (dropdown && btn && !dropdown.contains(event.target) && !btn.contains(event.target)) {
                dropdown.classList.remove('show');
            }

            // Close level dropdown
            const levelDropdown = document.getElementById('levelDropdown');
            const levelBtn = document.getElementById('levelDropdownBtn');
            if (levelDropdown && levelBtn && !levelDropdown.contains(event.target) && !levelBtn.contains(event.target)) {
                levelDropdown.classList.remove('show');
            }
        });

        function filterDay(day) {
            selectedDay = day;

            // Hide all day columns
            ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'].forEach(d => {
                const col = document.getElementById(d);
                if (d === day) {
                    col.style.display = 'block';
                } else {
                    col.style.display = 'none';
                }
            });

            // Update active state on headers
            document.querySelectorAll('.day-header[data-day]').forEach(header => {
                if (header.getAttribute('data-day') === day) {
                    header.classList.add('active');
                } else {
                    header.classList.remove('active');
                }
            });

            // Adjust calendar layout for single day view
            const calendarBody = document.querySelector('.calendar-body');
            const calendarHeader = document.querySelector('.calendar-header');
            calendarBody.style.gridTemplateColumns = '80px 1fr';
            calendarHeader.style.gridTemplateColumns = '80px 1fr';

            updateFilterStatus();
        }

        function showAllDays() {
            selectedDay = null;

            // Show all day columns
            ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'].forEach(d => {
                document.getElementById(d).style.display = 'block';
            });

            // Remove active state from all headers
            document.querySelectorAll('.day-header[data-day]').forEach(header => {
                header.classList.remove('active');
            });

            // Restore calendar layout
            const calendarBody = document.querySelector('.calendar-body');
            const calendarHeader = document.querySelector('.calendar-header');
            calendarBody.style.gridTemplateColumns = '80px repeat(5, minmax(180px, 1fr))';
            calendarHeader.style.gridTemplateColumns = '80px repeat(5, minmax(180px, 1fr))';

            updateFilterStatus();
        }

        // Room conflict detection
        function detectRoomConflicts() {
            roomConflicts = [];
            const roomGroups = {};

            // Normalize room key for consistent matching
            function normalizeRoomKey(building, room) {
                // Remove extra spaces, convert to uppercase for consistency
                const normBuilding = building.replace(/\s+/g, ' ').trim().toUpperCase();
                const normRoom = room.replace(/\s+/g, ' ').trim().toUpperCase();
                return `${normBuilding}|${normRoom}`;
            }

            // Group courses by room
            courses.forEach(course => {
                if (course.building === 'Not specified' || course.room === 'Not specified') return;
                const roomKey = normalizeRoomKey(course.building, course.room);
                if (!roomGroups[roomKey]) {
                    roomGroups[roomKey] = {
                        displayName: `${course.building} ${course.room}`,
                        courses: []
                    };
                }
                roomGroups[roomKey].courses.push(course);
            });

            // Check for overlaps within each room
            console.log(`📋 Checking ${Object.keys(roomGroups).length} rooms for conflicts...`);
            Object.keys(roomGroups).forEach(roomKey => {
                const roomData = roomGroups[roomKey];
                const roomCourses = roomData.courses;

                // Log rooms with multiple courses
                if (roomCourses.length >= 2) {
                    console.log(`  Room: ${roomData.displayName} has ${roomCourses.length} courses`);
                    roomCourses.forEach(c => {
                        console.log(`    - ${c.course_number} (${c.instructor}) ${c.days} ${c.time.raw}`);
                    });
                }

                if (roomCourses.length < 2) return;

                const conflicts = [];
                for (let i = 0; i < roomCourses.length; i++) {
                    for (let j = i + 1; j < roomCourses.length; j++) {
                        const course1 = roomCourses[i];
                        const course2 = roomCourses[j];

                        // Check if they share any days
                        const days1 = course1.days.split('');
                        const days2 = course2.days.split('');
                        const sharedDays = days1.filter(d => days2.includes(d));

                        if (sharedDays.length === 0) continue;

                        // Check if times overlap
                        const start1 = timeToMinutes(course1.time.start);
                        const end1 = timeToMinutes(course1.time.end);
                        const start2 = timeToMinutes(course2.time.start);
                        const end2 = timeToMinutes(course2.time.end);

                        if (start1 < end2 && end1 > start2) {
                            // We have a conflict
                            const existingConflict = conflicts.find(c =>
                                c.courses.some(co => co.crn === course1.crn || co.crn === course2.crn)
                            );

                            if (existingConflict) {
                                if (!existingConflict.courses.some(c => c.crn === course1.crn)) {
                                    existingConflict.courses.push(course1);
                                }
                                if (!existingConflict.courses.some(c => c.crn === course2.crn)) {
                                    existingConflict.courses.push(course2);
                                }
                            } else {
                                conflicts.push({
                                    room: roomData.displayName,
                                    courses: [course1, course2],
                                    sharedDays: sharedDays
                                });
                            }
                        }
                    }
                }

                roomConflicts.push(...conflicts);
            });

            // Log detected conflicts for debugging
            console.log(`🔍 Room Conflict Detection: Found ${roomConflicts.length} conflict group(s)`);
            roomConflicts.forEach((conflict, index) => {
                console.log(`  Conflict ${index + 1}: ${conflict.room} - ${conflict.courses.length} courses`);
                conflict.courses.forEach(c => {
                    console.log(`    - ${c.course_number} (${c.instructor}) ${c.days} ${c.time.raw}`);
                });
            });

            return roomConflicts;
        }

        function detectAndDisplayRoomConflicts() {
            const conflicts = detectRoomConflicts();
            const container = document.getElementById('conflictsContent');

            // Find courses with unspecified rooms
            const unspecifiedRooms = courses.filter(c =>
                c.room.toLowerCase().includes('not specified') ||
                c.room.toLowerCase().includes('tbd') ||
                c.room.toLowerCase().includes('tba') ||
                c.room.trim() === ''
            );

            let html = '';

            // Display unspecified rooms section
            if (unspecifiedRooms.length > 0) {
                html += `<div style="margin-bottom: 25px; padding: 18px; background-color: #e3f2fd; border-left: 4px solid #2980b9; border-radius: 8px;">
                    <strong>📋 Found ${unspecifiedRooms.length} course${unspecifiedRooms.length > 1 ? 's' : ''} with unspecified rooms</strong>
                    <p style="margin-top: 8px; color: #5f6368; font-size: 14px;">The following courses do not have room assignments:</p>
                </div>`;

                html += `<div style="margin-bottom: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border-left: 4px solid #2980b9;">
                    <div style="font-size: 16px; font-weight: 700; color: #202124; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <span>📍 Unspecified Rooms</span>
                        <span style="display: inline-block; padding: 3px 10px; background-color: #2980b9; color: white; border-radius: 12px; font-size: 11px; font-weight: 700;">${unspecifiedRooms.length} COURSES</span>
                    </div>
                    <div style="display: grid; gap: 12px;">`;

                unspecifiedRooms.forEach(course => {
                    const daysExpanded = expandDays(course.days);
                    html += `<div style="padding: 12px 15px; background-color: white; border-radius: 6px; border-left: 3px solid #2980b9;">
                        <div style="font-weight: 600; color: #202124; margin-bottom: 5px;">${course.course_number} - ${course.title}</div>
                        <div style="font-size: 13px; color: #5f6368;">
                            <strong>CRN:</strong> ${course.crn} |
                            <strong>Instructor:</strong> ${course.instructor}<br>
                            <strong>Time:</strong> ${course.time.raw} |
                            <strong>Days:</strong> ${daysExpanded} |
                            <strong>Room:</strong> ${course.room}
                        </div>
                    </div>`;
                });

                html += `</div></div>`;
            }

            // Display room conflicts
            if (conflicts.length === 0) {
                if (unspecifiedRooms.length === 0) {
                    html = '<div class="no-conflicts">✅ No room conflicts detected! All courses are scheduled without overlap.</div>';
                } else {
                    html += '<div class="no-conflicts">✅ No room conflicts detected for assigned rooms.</div>';
                }
                container.innerHTML = html;
                return;
            }

            html += `<div style="margin-bottom: 20px; padding: 15px; background-color: #fff3cd; border-left: 4px solid #ff6b6b; border-radius: 6px;">
                <strong>⚠️ Found ${conflicts.length} room conflict${conflicts.length > 1 ? 's' : ''}</strong>
                <p style="margin-top: 8px; color: #5f6368; font-size: 14px;">The following rooms have multiple courses scheduled at overlapping times:</p>
            </div>`;

            conflicts.forEach((conflict, index) => {
                // Generate conflict signature for persistence
                const crns = conflict.courses.map(c => c.crn).sort().join('-');
                const conflictSig = `${conflict.room}_${conflict.courses[0].days}_${conflict.courses[0].time.start}_${crns}`;
                const isIgnored = ignoredConflicts.has(conflictSig);

                html += `<div class="conflict-group${isIgnored ? ' conflict-hidden' : ''}" id="conflict-${index}" data-signature="${conflictSig}">
                    <button class="conflict-ignore-btn" onclick="toggleIgnoreConflict('${conflictSig}', ${index})">
                        ${isIgnored ? '↶ Show' : '✕ Ignore'}
                    </button>
                    <div class="conflict-header">
                        <span>📍 ${conflict.room}</span>
                        <span class="conflict-severity">${conflict.courses.length} COURSES</span>
                        ${isIgnored ? '<span style="margin-left: 10px; font-size: 12px; color: #666;">(Previously Ignored)</span>' : ''}
                    </div>
                    <p style="color: #721c24; font-size: 13px; margin: 10px 0;">These courses are scheduled in the same room at overlapping times:</p>
                    <div class="conflict-courses">`;

                conflict.courses.forEach(course => {
                    const daysExpanded = expandDays(course.days);
                    html += `<div class="conflict-course-item">
                        <div class="conflict-course-header">${course.course_number} - ${course.title}</div>
                        <div class="conflict-course-details">
                            <strong>CRN:</strong> ${course.crn} |
                            <strong>Instructor:</strong> ${course.instructor}<br>
                            <strong>Time:</strong> ${course.time.raw} |
                            <strong>Days:</strong> ${daysExpanded}
                        </div>
                    </div>`;
                });

                html += `</div></div>`;
            });

            // Add reset button if there are ignored conflicts
            if (ignoredConflicts.size > 0) {
                html += `<div style="margin-top: 20px; text-align: center;">
                    <button class="edit-action-btn btn-secondary" onclick="resetIgnoredConflicts()">
                        ↶ Reset All Ignored Conflicts (${ignoredConflicts.size})
                    </button>
                </div>`;
            }

            container.innerHTML = html;
        }

        // Toggle ignore conflict (with localStorage persistence)
        function toggleIgnoreConflict(signature, index) {
            const conflictElement = document.getElementById(`conflict-${index}`);
            if (!conflictElement) return;

            if (ignoredConflicts.has(signature)) {
                // Un-ignore
                ignoredConflicts.delete(signature);
                conflictElement.classList.remove('conflict-hidden');
            } else {
                // Ignore
                ignoredConflicts.add(signature);
                conflictElement.classList.add('conflict-hidden');
            }

            // Persist to localStorage
            localStorage.setItem('ignoredConflicts', JSON.stringify([...ignoredConflicts]));

            // Refresh the display to update button and counter
            detectAndDisplayRoomConflicts();
        }

        // Reset all ignored conflicts
        function resetIgnoredConflicts() {
            if (!confirm('Are you sure you want to reset all ignored conflicts? This will show all conflicts again.')) {
                return;
            }

            ignoredConflicts.clear();
            localStorage.removeItem('ignoredConflicts');
            detectAndDisplayRoomConflicts();
            showToast('↶ All ignored conflicts have been reset', 'info');
        }

        // Class list - show instructor schedules
        function generatePlanningMode() {
            const container = document.getElementById('planningModeContent');

            // Respect instructor filtering
            const allInstructors = [...new Set(courses.map(c => c.instructor))].sort();
            const instructors = selectedInstructors.size === 0
                ? allInstructors
                : allInstructors.filter(inst => selectedInstructors.has(inst));

            let html = '';

            if (instructors.length === 0) {
                html = '<div class="no-conflicts">📋 No instructors selected. Use the instructor filter above to select instructors to view their schedules.</div>';
                container.innerHTML = html;
                return;
            }

            instructors.forEach(instructor => {
                const instructorCourses = courses.filter(c => c.instructor === instructor);
                const instructorColor = getInstructorColor(instructor);

                html += `<div class="instructor-schedule">
                    <div class="instructor-schedule-header">
                        <span class="instructor-color-indicator" style="background-color: ${instructorColor}; width: 20px; height: 20px;"></span>
                        <span>${instructor} (${instructorCourses.length} course${instructorCourses.length > 1 ? 's' : ''})</span>
                    </div>
                    <div class="instructor-schedule-courses">`;

                instructorCourses.forEach(course => {
                    const daysExpanded = expandDays(course.days);
                    html += `<div class="schedule-course-item" style="border-left-color: ${instructorColor};">
                        <div class="schedule-course-title">${course.course_number} - ${course.title}</div>
                        <div class="schedule-course-details">
                            <strong>CRN:</strong> ${course.crn} |
                            <strong>Time:</strong> ${course.time.raw} |
                            <strong>Days:</strong> ${daysExpanded}<br>
                            <strong>Location:</strong> ${course.building} ${course.room} |
                            <strong>Credits:</strong> ${course.credits}
                        </div>
                    </div>`;
                });

                html += `</div></div>`;
            });

            container.innerHTML = html;
        }

        window.onclick = function(event) {
            if (event.target === document.getElementById('modal')) closeModal();
            if (event.target === document.getElementById('editModal')) closeEditModal();
        }

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
                closeEditModal();
            }
        });

        // ============================================================================
        // EDIT MODE FUNCTIONS
        // ============================================================================

        // Initialize edit mode
        function initializeEditMode() {
            populateTimePickers();
            populateInstructorDatalist();
            populateEditInstructorFilter();
            populateEditRoomDropdown();
            renderEditCalendar();
            displayEditModeConflicts();
            updateEditCount();
        }

        // Populate instructor checkboxes in edit mode
        function populateEditInstructorFilter() {
            const instructorList = document.getElementById('editInstructorList');
            instructorList.innerHTML = ''; // Clear existing
            const instructors = [...new Set(editedCourses.map(c => c.instructor))].sort();

            // Ensure all instructors have colors
            instructors.forEach(instructor => {
                if (!instructorColors[instructor]) {
                    // Generate a color if missing
                    const hue = Math.floor(Math.random() * 360);
                    instructorColors[instructor] = `hsl(${hue}, 70%, 60%)`;
                }
            });

            instructors.forEach(instructor => {
                const item = document.createElement('div');
                item.className = 'instructor-checkbox-item';

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `edit-instructor-${instructor.replace(/\s+/g, '-')}`;
                checkbox.value = instructor;
                checkbox.checked = editSelectedInstructors.size === 0 || editSelectedInstructors.has(instructor);
                checkbox.onchange = () => toggleEditInstructorSelection(instructor);

                const label = document.createElement('label');
                label.setAttribute('for', checkbox.id);

                const colorIndicator = document.createElement('span');
                colorIndicator.className = 'instructor-color-indicator';
                colorIndicator.style.backgroundColor = getInstructorColor(instructor);

                label.appendChild(colorIndicator);
                label.appendChild(document.createTextNode(instructor));

                item.appendChild(checkbox);
                item.appendChild(label);
                instructorList.appendChild(item);
            });
        }

        // Populate room filter dropdown in edit mode
        // Toggle instructor dropdown in edit mode
        function toggleEditInstructorDropdown() {
            const dropdown = document.getElementById('editInstructorDropdown');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }

        // Toggle single instructor selection in edit mode
        function toggleEditInstructorSelection(instructor) {
            if (editSelectedInstructors.has(instructor)) {
                editSelectedInstructors.delete(instructor);
            } else {
                editSelectedInstructors.add(instructor);
            }
            updateEditInstructorButtonText();
            applyEditFilters();
        }

        // Select all instructors in edit mode
        function selectAllEditInstructors() {
            editSelectedInstructors.clear();
            document.querySelectorAll('#editInstructorList input[type="checkbox"]').forEach(cb => {
                cb.checked = true;
            });
            updateEditInstructorButtonText();
            applyEditFilters();
        }

        // Clear all instructors in edit mode
        function clearAllEditInstructors() {
            editSelectedInstructors.clear();
            document.querySelectorAll('#editInstructorList input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
                editSelectedInstructors.add(cb.value);
            });
            // Start with one instructor selected
            const firstCheckbox = document.querySelector('#editInstructorList input[type="checkbox"]');
            if (firstCheckbox) {
                firstCheckbox.checked = true;
                editSelectedInstructors.clear();
                editSelectedInstructors.add(firstCheckbox.value);
            }
            updateEditInstructorButtonText();
            applyEditFilters();
        }

        // Update instructor button text in edit mode
        function updateEditInstructorButtonText() {
            const btnText = document.getElementById('editInstructorBtnText');
            if (editSelectedInstructors.size === 0) {
                btnText.textContent = 'All Instructors';
            } else if (editSelectedInstructors.size === 1) {
                btnText.textContent = Array.from(editSelectedInstructors)[0];
            } else {
                btnText.textContent = `${editSelectedInstructors.size} Instructors`;
            }
        }

        // Edit mode room filter dropdown
        function toggleEditRoomDropdown() {
            const dropdown = document.getElementById('editRoomDropdown');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }

        function setEditRoomFilter(room) {
            editRoomFilter = room;
            const btnText = document.getElementById('editRoomBtnText');
            btnText.textContent = room === 'all' ? 'All Rooms' : room;
            document.getElementById('editRoomDropdown').style.display = 'none';
            applyEditFilters();
        }

        function populateEditRoomDropdown() {
            const roomSet = new Set();
            editedCourses.forEach(course => {
                if (course.building !== 'Not specified' && course.room !== 'Not specified') {
                    roomSet.add(`${course.building} ${course.room}`);
                }
            });
            const rooms = ['all', ...Array.from(roomSet).sort()];
            const dropdown = document.getElementById('editRoomList');
            dropdown.innerHTML = '';
            rooms.forEach(room => {
                const item = document.createElement('div');
                item.className = 'instructor-checkbox-item';
                item.onclick = () => setEditRoomFilter(room);
                const label = document.createElement('label');
                label.style.cursor = 'pointer';
                label.textContent = room === 'all' ? 'All Rooms' : room;
                item.appendChild(label);
                dropdown.appendChild(item);
            });
        }

        // Edit mode level filter dropdown
        function toggleEditLevelDropdown() {
            const dropdown = document.getElementById('editLevelDropdown');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }

        function setEditLevelFilter(level) {
            editLevelFilter = level;
            const btnText = document.getElementById('editLevelBtnText');
            if (level === 'all') {
                btnText.textContent = 'All Levels';
            } else if (level === 'undergrad') {
                btnText.textContent = 'Undergrad';
            } else if (level === 'grad') {
                btnText.textContent = 'Grad';
            }
            document.getElementById('editLevelDropdown').style.display = 'none';
            applyEditFilters();
        }

        // Apply edit mode filters
        function applyEditFilters() {
            // Skip rendering if we're currently importing data
            if (isImporting) {
                console.log('applyEditFilters: Skipping render during import');
                return;
            }

            // Update status text
            let statusParts = [];

            if (editRoomFilter !== 'all') {
                statusParts.push(`Room: <strong>${editRoomFilter}</strong>`);
            }

            // Add level filter status
            if (editLevelFilter === 'undergrad') {
                statusParts.push('<strong>undergrad only</strong>');
            } else if (editLevelFilter === 'grad') {
                statusParts.push('<strong>grad only</strong>');
            } else {
                statusParts.push('<strong>all levels</strong>');
            }

            if (editSelectedInstructors.size === 0) {
                statusParts.push('<strong>all instructors</strong>');
            } else if (editSelectedInstructors.size === 1) {
                statusParts.push(Array.from(editSelectedInstructors)[0]);
            } else {
                statusParts.push(`<strong>${editSelectedInstructors.size} instructors</strong>`);
            }

            document.getElementById('editFilterStatus').innerHTML = statusParts.join(' | ');

            // Re-render calendar with filters
            renderEditCalendar();
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            // Close instructor dropdown
            const editDropdown = document.getElementById('editInstructorDropdown');
            const editDropdownBtn = document.getElementById('editInstructorDropdownBtn');
            if (editDropdown && !editDropdownBtn.contains(event.target) && !editDropdown.contains(event.target)) {
                editDropdown.style.display = 'none';
            }

            // Close room dropdown
            const roomDropdown = document.getElementById('editRoomDropdown');
            const roomBtn = document.getElementById('editRoomDropdownBtn');
            if (roomDropdown && roomBtn && !roomDropdown.contains(event.target) && !roomBtn.contains(event.target)) {
                roomDropdown.style.display = 'none';
            }

            // Close level dropdown
            const levelDropdown = document.getElementById('editLevelDropdown');
            const levelBtn = document.getElementById('editLevelDropdownBtn');
            if (levelDropdown && levelBtn && !levelDropdown.contains(event.target) && !levelBtn.contains(event.target)) {
                levelDropdown.style.display = 'none';
            }
        });

        // Populate time picker dropdowns with 5-minute intervals
        function populateTimePickers() {
            const startSelect = document.getElementById('editStartTime');
            const endSelect = document.getElementById('editEndTime');

            if (startSelect.options.length > 0) return; // Already populated

            const times = [];
            for (let hour = 9; hour <= 21; hour++) {
                for (let min = 0; min < 60; min += 5) {
                    const period = hour >= 12 ? 'PM' : 'AM';
                    const displayHour = hour > 12 ? hour - 12 : (hour === 0 ? 12 : hour);
                    const timeStr = `${displayHour.toString().padStart(2, '0')}:${min.toString().padStart(2, '0')}${period}`;
                    times.push(timeStr);
                }
            }

            times.forEach(time => {
                startSelect.add(new Option(time, time));
                endSelect.add(new Option(time, time));
            });
        }

        // Populate instructor datalist
        function populateInstructorDatalist() {
            const datalist = document.getElementById('instructorList');
            const instructors = [...new Set(editedCourses.map(c => c.instructor))].sort();
            datalist.innerHTML = '';
            instructors.forEach(instructor => {
                const option = document.createElement('option');
                option.value = instructor;
                datalist.appendChild(option);
            });
        }


        // Render edit calendar with overlap detection
        function renderEditCalendar() {
            const editTimeColumn = document.getElementById('editTimeColumn');
            const startHour = 9;
            const pixelsPerMinute = 1;

            // Create time slots
            editTimeColumn.innerHTML = '';
            for (let hour = 9; hour <= 21; hour++) {
                const timeSlot = document.createElement('div');
                timeSlot.className = 'time-slot';
                const period = hour >= 12 ? 'PM' : 'AM';
                const displayHour = hour > 12 ? hour - 12 : hour;
                timeSlot.textContent = `${displayHour}:00 ${period}`;
                editTimeColumn.appendChild(timeSlot);
            }

            // Clear day columns
            ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'].forEach(day => {
                document.getElementById(`edit-${day}`).innerHTML = '';
            });

            // Group courses by day with filters applied
            const coursesByDay = { monday: [], tuesday: [], wednesday: [], thursday: [], friday: [] };
            editedCourses.forEach(course => {
                if (!course.days || !course.time) return;

                // Apply instructor filter
                const instructorMatch = editSelectedInstructors.size === 0 || editSelectedInstructors.has(course.instructor);
                if (!instructorMatch) return;

                // Apply room filter
                const courseRoom = `${course.building} ${course.room}`;
                if (editRoomFilter !== 'all' && courseRoom !== editRoomFilter) return;

                // Apply level filter
                if (editLevelFilter === 'undergrad' && isGraduateCourse(course.course_number)) return;
                if (editLevelFilter === 'grad' && !isGraduateCourse(course.course_number)) return;

                course.days.split('').forEach(dayLetter => {
                    const dayName = dayMap[dayLetter];
                    if (dayName) coursesByDay[dayName].push(course);
                });
            });

            // Render courses with overlap detection
            Object.keys(coursesByDay).forEach(dayName => {
                const dayColumn = document.getElementById(`edit-${dayName}`);
                const coursesForDay = coursesByDay[dayName];

                // Debug: Log all courses for Tuesday to see what's being grouped
                if (dayName === 'tuesday') {
                    console.log('=== DEBUG TUESDAY COURSES (BEFORE SORT) ===');
                    console.log('Total courses on Tuesday:', coursesForDay.length);
                    coursesForDay.forEach((c, idx) => {
                        const mins = timeToMinutes(c.time.start);
                        console.log(`[${idx}] CRN ${c.crn}: ${c.time.start} - ${c.time.end} (start=${mins} mins) | ${c.course_number} ${c.title}`);
                    });
                }

                // Sort by start time
                coursesForDay.sort((a, b) => timeToMinutes(a.time.start) - timeToMinutes(b.time.start));

                // Debug: Log after sorting
                if (dayName === 'tuesday') {
                    console.log('=== DEBUG TUESDAY COURSES (AFTER SORT) ===');
                    coursesForDay.forEach((c, idx) => {
                        const mins = timeToMinutes(c.time.start);
                        console.log(`[${idx}] CRN ${c.crn}: ${c.time.start} - ${c.time.end} (start=${mins} mins) | ${c.course_number} ${c.title}`);
                    });
                }

                const processed = new Set();

                coursesForDay.forEach((course, index) => {
                    if (processed.has(index)) return;

                    const startMinutes = timeToMinutes(course.time.start);
                    const endMinutes = timeToMinutes(course.time.end);
                    const duration = endMinutes - startMinutes;
                    const topPosition = (startMinutes - (startHour * 60)) * pixelsPerMinute;
                    const height = duration * pixelsPerMinute;

                    // Debug log for ALL courses on Tuesday to see positioning
                    if (dayName === 'tuesday') {
                        console.log(`=== RENDER CRN ${course.crn} ===`);
                        console.log('  time.start:', course.time.start, '→', startMinutes, 'minutes');
                        console.log('  time.end:', course.time.end, '→', endMinutes, 'minutes');
                        console.log('  duration:', duration, 'minutes');
                        console.log('  topPosition:', topPosition, 'px');
                        console.log('  height:', height, 'px');
                    }

                    // Find overlapping courses
                    const overlapping = [];
                    for (let i = index + 1; i < coursesForDay.length; i++) {
                        if (processed.has(i)) continue;
                        const other = coursesForDay[i];
                        const otherStart = timeToMinutes(other.time.start);
                        const otherEnd = timeToMinutes(other.time.end);
                        if (startMinutes < otherEnd && endMinutes > otherStart) {
                            overlapping.push({course: other, index: i});
                        }
                    }

                    // Calculate widths and positions
                    const totalOverlapping = overlapping.length + 1;
                    const widthPercent = 100 / totalOverlapping;

                    // Render main course
                    renderEditCourseBlock(course, dayColumn, topPosition, height, 0, widthPercent);
                    processed.add(index);

                    // Render overlapping courses
                    overlapping.forEach((item, i) => {
                        const otherStartMinutes = timeToMinutes(item.course.time.start);
                        const otherEndMinutes = timeToMinutes(item.course.time.end);
                        const otherDuration = otherEndMinutes - otherStartMinutes;
                        const otherTopPosition = (otherStartMinutes - (startHour * 60)) * pixelsPerMinute;
                        const otherHeight = otherDuration * pixelsPerMinute;
                        renderEditCourseBlock(item.course, dayColumn, otherTopPosition, otherHeight, i + 1, widthPercent);
                        processed.add(item.index);
                    });
                });
            });
        }

        // Render editable course block with overlap support
        function renderEditCourseBlock(course, dayColumn, topPosition, height, column, widthPercent) {
            const block = document.createElement('div');
            block.className = 'course-block';

            // Debug Tuesday renders
            if (dayColumn.id === 'edit-tuesday' && course.time.start === '11:00AM') {
                console.log(`  → renderEditCourseBlock CRN ${course.crn}: top=${topPosition}px, left=${(column * widthPercent).toFixed(1)}%, width=${widthPercent.toFixed(1)}%, column=${column}`);
            }

            // Mark edited courses
            if (editedCRNs.has(course.crn)) {
                block.classList.add('edited');
            }

            // Position and size
            block.style.top = `${topPosition}px`;
            block.style.height = `${height}px`;
            block.style.left = `${column * widthPercent}%`;
            block.style.width = `calc(${widthPercent}% - 4px)`;

            // Use instructor-specific color
            block.style.background = getInstructorColor(course.instructor);

            block.innerHTML = `
                <div class="course-number">${course.course_number}</div>
                <div class="course-name">${course.title}</div>
                <div class="course-time">${course.time.start}</div>
                <div class="tooltip">
                    <div class="tooltip-row"><span class="tooltip-label">Course:</span><span class="tooltip-value">${course.course_number}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">Title:</span><span class="tooltip-value">${course.title}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">Instructor:</span><span class="tooltip-value">${course.instructor}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">Time:</span><span class="tooltip-value">${course.time.raw}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">Room:</span><span class="tooltip-value">${course.building} ${course.room}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">CRN:</span><span class="tooltip-value">${course.crn}</span></div>
                    <div class="tooltip-row"><span class="tooltip-label">Credits:</span><span class="tooltip-value">${course.credits}</span></div>
                    ${editedCRNs.has(course.crn) ? '<div class="tooltip-row" style="color: #fbbc04; font-weight: 700;">⚠️ Modified</div>' : ''}
                    <div class="tooltip-row" style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #555; font-style: italic; color: #aaa;">Click to edit</div>
                </div>
            `;

            block.onclick = () => openEditCourseModal(course);

            dayColumn.appendChild(block);
        }

        // Detect conflicts in edited courses (separate conflicts by specific time/day)
        function detectEditModeConflicts() {
            const conflicts = [];
            const roomGroups = {};

            // Normalize room key for consistent matching
            function normalizeRoomKey(building, room) {
                const normBuilding = building.replace(/\s+/g, ' ').trim().toUpperCase();
                const normRoom = room.replace(/\s+/g, ' ').trim().toUpperCase();
                return `${normBuilding}|${normRoom}`;
            }

            // Group edited courses by room
            editedCourses.forEach(course => {
                if (course.building === 'Not specified' || course.room === 'Not specified') return;
                const roomKey = normalizeRoomKey(course.building, course.room);
                if (!roomGroups[roomKey]) {
                    roomGroups[roomKey] = {
                        displayName: `${course.building} ${course.room}`,
                        courses: []
                    };
                }
                roomGroups[roomKey].courses.push(course);
            });

            // Check for overlaps within each room and group by day/time window
            Object.keys(roomGroups).forEach(roomKey => {
                const roomData = roomGroups[roomKey];
                const roomCourses = roomData.courses;

                if (roomCourses.length < 2) return;

                const conflictGroups = {};

                // Find all pairs with overlaps
                for (let i = 0; i < roomCourses.length; i++) {
                    for (let j = i + 1; j < roomCourses.length; j++) {
                        const course1 = roomCourses[i];
                        const course2 = roomCourses[j];

                        // Check if they share any days
                        const days1 = course1.days.split('');
                        const days2 = course2.days.split('');
                        const sharedDays = days1.filter(d => days2.includes(d));

                        if (sharedDays.length === 0) continue;

                        // Check if times overlap
                        const start1 = timeToMinutes(course1.time.start);
                        const end1 = timeToMinutes(course1.time.end);
                        const start2 = timeToMinutes(course2.time.start);
                        const end2 = timeToMinutes(course2.time.end);

                        if (start1 < end2 && end1 > start2) {
                            // Found overlap - group by room + days + overlapping time window
                            const overlapStart = Math.max(start1, start2);
                            const overlapEnd = Math.min(end1, end2);
                            const daysKey = sharedDays.sort().join('');
                            const groupKey = `${roomData.displayName}_${daysKey}_${overlapStart}_${overlapEnd}`;

                            if (!conflictGroups[groupKey]) {
                                conflictGroups[groupKey] = {
                                    room: roomData.displayName,
                                    sharedDays: sharedDays,
                                    courses: [],
                                    overlapStart: overlapStart,
                                    overlapEnd: overlapEnd
                                };
                            }

                            // Add courses if not already in group
                            const group = conflictGroups[groupKey];
                            if (!group.courses.find(c => c.crn === course1.crn)) {
                                group.courses.push(course1);
                            }
                            if (!group.courses.find(c => c.crn === course2.crn)) {
                                group.courses.push(course2);
                            }
                        }
                    }
                }

                // Add conflict groups to results
                Object.values(conflictGroups).forEach(group => {
                    conflicts.push(group);
                });
            });

            return conflicts;
        }

        // Display conflicts in edit mode (using same style as Room Conflicts tab)
        function displayEditModeConflicts() {
            const conflicts = detectEditModeConflicts();
            const container = document.getElementById('editConflictsContent');

            if (conflicts.length === 0) {
                container.innerHTML = '<div class="no-conflicts">✅ No conflicts detected! All courses are scheduled without overlap.</div>';
                return;
            }

            let html = `<div style="margin-bottom: 20px; padding: 15px; background-color: #fff3cd; border-left: 4px solid #ff6b6b; border-radius: 6px;">
                <strong>⚠️ Found ${conflicts.length} conflict${conflicts.length > 1 ? 's' : ''}</strong>
                <p style="margin-top: 8px; color: #5f6368; font-size: 14px;">The following rooms have multiple courses scheduled at overlapping times:</p>
            </div>`;

            conflicts.forEach((conflict, index) => {
                // Generate conflict signature for persistence
                const crns = conflict.courses.map(c => c.crn).sort().join('-');
                const daysStr = conflict.sharedDays.join('');
                const timeStr = conflict.courses[0].time.start;
                const conflictSig = `${conflict.room}_${daysStr}_${timeStr}_${crns}`;
                const isIgnored = editIgnoredConflicts.has(conflictSig);

                html += `<div class="conflict-group${isIgnored ? ' conflict-hidden' : ''}" id="edit-conflict-${index}" data-signature="${conflictSig}">
                    <button class="conflict-ignore-btn" onclick="toggleEditIgnoreConflict('${conflictSig}')">
                        ${isIgnored ? '↶ Show' : '✕ Ignore'}
                    </button>
                    <div class="conflict-header">
                        <span>📍 ${conflict.room}</span>
                        <span class="conflict-severity">${conflict.courses.length} COURSES</span>
                        ${isIgnored ? '<span style="margin-left: 10px; font-size: 12px; color: #666;">(Previously Ignored)</span>' : ''}
                    </div>
                    <p style="color: #721c24; font-size: 13px; margin: 10px 0;">These courses are scheduled in the same room at overlapping times on <strong>${conflict.sharedDays.map(d => ({'M':'Monday','T':'Tuesday','W':'Wednesday','R':'Thursday','F':'Friday'}[d])).join(', ')}</strong></p>
                    <div class="conflict-courses">`;

                conflict.courses.forEach(course => {
                    const daysExpanded = expandDays(course.days);
                    html += `<div class="conflict-course-item">
                        <div class="conflict-course-header">${course.course_number} - ${course.title}</div>
                        <div class="conflict-course-details">
                            <strong>CRN:</strong> ${course.crn} |
                            <strong>Instructor:</strong> ${course.instructor}<br>
                            <strong>Time:</strong> ${course.time.raw} |
                            <strong>Days:</strong> ${daysExpanded}
                        </div>
                    </div>`;
                });

                html += `</div></div>`;
            });

            // Add reset button if there are ignored conflicts
            if (editIgnoredConflicts.size > 0) {
                html += `<div style="margin-top: 20px; text-align: center;">
                    <button class="edit-action-btn btn-secondary" onclick="resetEditIgnoredConflicts()">
                        ↶ Reset All Ignored Conflicts (${editIgnoredConflicts.size})
                    </button>
                </div>`;
            }

            container.innerHTML = html;
        }

        // Toggle ignore for edit mode conflicts
        function toggleEditIgnoreConflict(signature) {
            if (editIgnoredConflicts.has(signature)) {
                editIgnoredConflicts.delete(signature);
            } else {
                editIgnoredConflicts.add(signature);
            }
            localStorage.setItem('editIgnoredConflicts', JSON.stringify([...editIgnoredConflicts]));
            displayEditModeConflicts();
        }

        // Reset ignored conflicts in edit mode
        function resetEditIgnoredConflicts() {
            if (!confirm('Are you sure you want to reset all ignored conflicts? They will all be shown again.')) return;
            editIgnoredConflicts.clear();
            localStorage.removeItem('editIgnoredConflicts');
            displayEditModeConflicts();
        }

        // Open modal to add new course
        function openAddCourseModal() {
            currentEditCRN = null;
            document.getElementById('editModalTitle').textContent = 'Add New Course';
            document.getElementById('editCourseForm').reset();
            document.getElementById('deleteCourseBtn').style.display = 'none';
            document.getElementById('duplicateCourseBtn').style.display = 'none';

            // Set default CRN
            document.getElementById('editCRNInput').value = 'XXXXX';

            // Set default subject code from existing courses
            const defaultSubject = editedCourses.length > 0 ? editedCourses[0].subject : '';
            document.getElementById('editSubject').value = defaultSubject;

            // Set default section
            document.getElementById('editSection').value = '10';

            // Set default credits
            document.getElementById('editCredits').value = '3';

            document.getElementById('editModal').style.display = 'block';
        }

        // Open modal to edit existing course
        function openEditCourseModal(course) {
            currentEditCRN = course.crn;
            document.getElementById('editModalTitle').textContent = 'Edit Course';
            document.getElementById('deleteCourseBtn').style.display = 'inline-block';
            document.getElementById('duplicateCourseBtn').style.display = 'inline-block';

            // Populate form
            document.getElementById('editCRN').value = course.crn;
            document.getElementById('originalCRN').value = course.crn;
            document.getElementById('editSubject').value = course.subject || '';
            document.getElementById('editCourseNum').value = course.course_num || '';
            document.getElementById('editSection').value = course.section || '';
            document.getElementById('editCRNInput').value = course.crn || '';
            document.getElementById('editTitle').value = course.title || '';
            document.getElementById('editCredits').value = course.credits || '';
            document.getElementById('editInstructor').value = course.instructor || '';
            document.getElementById('editStartTime').value = course.time.start || '';
            document.getElementById('editEndTime').value = course.time.end || '';
            document.getElementById('editBuilding').value = course.building || '';
            document.getElementById('editRoom').value = course.room || '';
            document.getElementById('editDates').value = course.dates || '';

            // Set days
            document.querySelectorAll('input[name="editDay"]').forEach(cb => cb.checked = false);
            if (course.days) {
                course.days.split('').forEach(day => {
                    const checkbox = document.querySelector(`input[name="editDay"][value="${day}"]`);
                    if (checkbox) checkbox.checked = true;
                });
            }

            document.getElementById('editModal').style.display = 'block';
        }

        // Close edit modal
        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            document.getElementById('daysError').style.display = 'none';
            document.getElementById('timeError').style.display = 'none';
        }

        // Save course edit
        function saveCourseEdit(event) {
            event.preventDefault();

            // Validate days
            const selectedDays = Array.from(document.querySelectorAll('input[name="editDay"]:checked'))
                .map(cb => cb.value).join('');
            if (!selectedDays) {
                document.getElementById('daysError').style.display = 'block';
                return;
            } else {
                document.getElementById('daysError').style.display = 'none';
            }

            // Validate times
            const startTime = document.getElementById('editStartTime').value;
            const endTime = document.getElementById('editEndTime').value;
            if (timeToMinutes(startTime) >= timeToMinutes(endTime)) {
                document.getElementById('timeError').style.display = 'block';
                return;
            } else {
                document.getElementById('timeError').style.display = 'none';
            }

            // Get form data
            const newCRN = document.getElementById('editCRNInput').value;
            const originalCRN = document.getElementById('originalCRN').value;

            const courseData = {
                crn: newCRN,
                subject: document.getElementById('editSubject').value,
                course_num: document.getElementById('editCourseNum').value,
                section: document.getElementById('editSection').value,
                title: document.getElementById('editTitle').value,
                credits: document.getElementById('editCredits').value,
                instructor: document.getElementById('editInstructor').value,
                days: selectedDays,
                time: {
                    start: startTime,
                    end: endTime,
                    raw: `${startTime} - ${endTime}`
                },
                building: document.getElementById('editBuilding').value || 'Not specified',
                room: document.getElementById('editRoom').value || 'Not specified',
                dates: document.getElementById('editDates').value || '01/12/26 - 04/27/26',
                course_number: `${document.getElementById('editSubject').value} ${document.getElementById('editCourseNum').value}`,
                status: 'OPEN'
            };

            // Update or add course
            if (originalCRN) {
                // Editing existing course
                const index = editedCourses.findIndex(c => c.crn === originalCRN);
                if (index !== -1) {
                    editedCourses[index] = courseData;
                    editedCRNs.add(newCRN);
                    if (originalCRN !== newCRN) {
                        editedCRNs.delete(originalCRN);
                    }
                }
            } else {
                // Adding new course
                editedCourses.push(courseData);
                editedCRNs.add(newCRN);
            }

            editCount++;
            updateEditCount();
            populateEditInstructorFilter();
            populateEditRoomFilter();
            renderEditCalendar();
            displayEditModeConflicts();
            populateInstructorDatalist();
            closeEditModal();

            showToast('✅ Course saved successfully!', 'success');
        }

        // Delete course
        function deleteCourse() {
            if (!confirm('Are you sure you want to delete this course? This cannot be undone.')) {
                return;
            }

            const crn = document.getElementById('editCRNInput').value;
            const index = editedCourses.findIndex(c => c.crn === crn);

            if (index !== -1) {
                editedCourses.splice(index, 1);
                editedCRNs.delete(crn);
                editCount++;
                updateEditCount();
                populateEditInstructorFilter();
                populateEditRoomFilter();
                renderEditCalendar();
                displayEditModeConflicts();
                closeEditModal();
                showToast('🗑️ Course deleted', 'info');
            }
        }

        // Duplicate course
        function duplicateCourse() {
            const originalCRN = document.getElementById('editCRNInput').value;
            const originalCourse = editedCourses.find(c => c.crn === originalCRN);

            if (!originalCourse) return;

            // Generate new CRN and increment section
            const maxCRN = Math.max(...editedCourses.map(c => parseInt(c.crn) || 0));
            const newCRN = (maxCRN + 1).toString();
            const sectionNum = parseInt(originalCourse.section) || 10;
            const newSection = (sectionNum + 10).toString();

            const duplicatedCourse = {
                ...originalCourse,
                crn: newCRN,
                section: newSection,
                course_number: `${originalCourse.subject} ${originalCourse.course_num}`
            };

            editedCourses.push(duplicatedCourse);
            editedCRNs.add(newCRN);
            editCount++;
            updateEditCount();
            populateEditInstructorFilter();
            populateEditRoomFilter();
            renderEditCalendar();
            displayEditModeConflicts();
            closeEditModal();

            showToast('📋 Course duplicated successfully!', 'success');
        }

        // Update edit count display
        function updateEditCount() {
            document.getElementById('editCount').textContent = editedCRNs.size;
        }

        // Export to CSV
        function exportToCSV() {
            // Sort by instructor, then by course_number
            const sortedCourses = [...editedCourses].sort((a, b) => {
                const instructorCompare = (a.instructor || '').localeCompare(b.instructor || '');
                if (instructorCompare !== 0) return instructorCompare;
                return (a.course_number || '').localeCompare(b.course_number || '');
            });

            const headers = ['CRN', 'Subject', 'CourseNum', 'Section', 'Title', 'Credits', 'Instructor', 'Days', 'StartTime', 'EndTime', 'Building', 'Room', 'Dates'];
            const rows = sortedCourses.map(c => [
                c.crn,
                c.subject,
                c.course_num,
                c.section,
                c.title,
                c.credits,
                c.instructor,
                c.days,
                c.time.start,
                c.time.end,
                c.building,
                c.room,
                c.dates
            ]);

            const csvContent = [
                headers.join(','),
                ...rows.map(row => row.map(cell => {
                    const cellStr = (cell || '').toString();
                    // Escape quotes and wrap in quotes if contains comma or quote
                    if (cellStr.includes(',') || cellStr.includes('"') || cellStr.includes('\n')) {
                        return `"${cellStr.replace(/"/g, '""')}"`;
                    }
                    return cellStr;
                }).join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `schedule_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            URL.revokeObjectURL(url);

            showToast('📥 CSV exported successfully!', 'success');
        }

        // Handle CSV import
        function handleCSVImport(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const csv = e.target.result;
                const lines = csv.split('\n').filter(line => line.trim());

                if (lines.length === 0) {
                    showToast('❌ CSV file is empty', 'error');
                    return;
                }

                const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));

                const imported = [];
                for (let i = 1; i < lines.length; i++) {
                    const values = parseCSVLine(lines[i]);

                    console.log(`Row ${i}: parsed ${values.length} columns`, values);

                    if (values.length < 6) {
                        console.warn(`Skipping row ${i}: only ${values.length} columns (need at least 6)`);
                        continue;
                    }

                    // Parse the course data with proper validation
                    // CSV format: CRN, Subject, CourseNum, Section, Title, Credits, Instructor, Days, StartTime, EndTime, Building, Room, Dates
                    const crn = values[0]?.trim();
                    const subject = values[1]?.trim() || 'GEOG';
                    const course_num = values[2]?.trim();
                    const section = values[3]?.trim();
                    const title = values[4]?.trim();
                    const credits = values[5]?.trim() || '0.00';
                    const instructor = values[6]?.trim();
                    const days = values[7]?.trim() || 'MW';
                    const startTime = values[8]?.trim() || '09:00AM';
                    const endTime = values[9]?.trim() || '10:00AM';
                    const building = values[10]?.trim() || 'Not specified';
                    const room = values[11]?.trim() || 'Not specified';
                    const dates = values[12]?.trim() || '01/12/26 - 04/27/26';

                    if (!crn || !title || !instructor) {
                        console.warn(`Skipping row ${i}: missing required fields - CRN=${crn}, Title=${title}, Instructor=${instructor}`);
                        continue;
                    }

                    // Validate time format
                    if (!startTime.match(/\d{1,2}:\d{2}[AP]M/) || !endTime.match(/\d{1,2}:\d{2}[AP]M/)) {
                        console.warn(`Skipping row ${i}: invalid time format - Start=${startTime}, End=${endTime}`);
                        continue;
                    }

                    // Validate days format
                    if (!days.match(/^[MTWRF]+$/)) {
                        console.warn(`Skipping row ${i}: invalid days format - Days=${days}`);
                        continue;
                    }

                    // Create course object matching EXACT scraper format
                    const course = {
                        status: 'OPEN',
                        crn: crn,
                        subject: subject,
                        course_num: course_num,
                        section: section,
                        title: title,
                        credits: credits,
                        instructor: instructor,
                        days: days,
                        time: {
                            start: startTime,
                            end: endTime,
                            raw: `${startTime} - ${endTime}`
                        },
                        dates: dates,
                        building: building,
                        room: room,
                        course_number: `${subject} ${course_num}`
                    };

                    // Debug log for problematic course
                    if (crn === '43789') {
                        console.log('=== DEBUG CRN 43789 IMPORT ===');
                        console.log('Raw CSV values:', values);
                        console.log('StartTime from CSV (index 8):', values[8]);
                        console.log('EndTime from CSV (index 9):', values[9]);
                        console.log('Parsed startTime:', startTime);
                        console.log('Parsed endTime:', endTime);
                        console.log('Full course object:', JSON.stringify(course, null, 2));
                        console.log('timeToMinutes(startTime):', timeToMinutes(startTime));
                        console.log('timeToMinutes(endTime):', timeToMinutes(endTime));
                    }

                    imported.push(course);
                }

                if (imported.length === 0) {
                    showToast('❌ No valid courses found in CSV', 'error');
                    return;
                }

                if (confirm(`Import ${imported.length} courses? This will REPLACE all current courses in edit mode.`)) {
                    console.log('=== CSV IMPORT: REPLACING editedCourses ===');
                    console.log('Old editedCourses length:', editedCourses.length);
                    console.log('New imported length:', imported.length);

                    // Set flag to prevent multiple renders during import
                    isImporting = true;

                    // REPLACE all courses with imported data (not merge)
                    editedCourses = imported;
                    editedCRNs.clear();

                    // Mark all imported courses as edited
                    imported.forEach(course => {
                        editedCRNs.add(course.crn);
                    });

                    console.log('After replacement - editedCourses length:', editedCourses.length);
                    console.log('After replacement - editedCourses === imported?', editedCourses === imported);

                    // Verify first 3 courses in editedCourses
                    console.log('=== FIRST 3 COURSES IN editedCourses ===');
                    editedCourses.slice(0, 3).forEach((c, idx) => {
                        console.log(`[${idx}] CRN ${c.crn}: ${c.days} ${c.time.start}-${c.time.end} | ${c.course_number} ${c.title}`);
                    });

                    editCount = imported.length;
                    updateEditCount();
                    populateEditInstructorFilter();
                    populateEditRoomFilter();

                    // Clear the flag before rendering
                    isImporting = false;

                    // Now render once
                    console.log('CSV Import: Rendering calendar once...');
                    renderEditCalendar();
                    displayEditModeConflicts();
                    populateInstructorDatalist();
                    showToast(`📤 Imported ${imported.length} courses successfully!`, 'success');
                }
            };
            reader.readAsText(file);
            event.target.value = ''; // Reset file input
        }

        // Parse CSV line handling quotes and commas
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;

            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                const nextChar = line[i + 1];

                if (char === '"' && inQuotes && nextChar === '"') {
                    current += '"';
                    i++;
                } else if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current.trim());
            return result;
        }

        // Download modified JSON
        function downloadModifiedJSON() {
            const json = JSON.stringify(editedCourses, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `gwu_course_calendar_edited_${new Date().toISOString().slice(0,10)}.json`;
            a.click();
            URL.revokeObjectURL(url);

            showToast('💾 JSON saved successfully!', 'success');
        }

        // Show toast notification
        function showToast(message, type) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                background: ${type === 'success' ? '#34a853' : type === 'error' ? '#ea4335' : '#4285f4'};
                color: white;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                font-weight: 600;
                animation: slideIn 0.3s ease;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ============================================================================
        // END EDIT MODE FUNCTIONS
        // ============================================================================

        // Initialize
        generateInstructorColors();
        detectRoomConflicts();
        createTimeSlots();
        renderCourses();
        populateInstructorList();
        updateInstructorLegend();
    </script>
    </div> <!-- end main-content -->

    <!-- Read the Docs style footer -->
    <footer class="rtd-footer">
        <div class="rtd-footer-content">
            <div class="rtd-footer-left">
                <strong>GWU Course Calendar Scraper</strong><br>
                Interactive course schedule viewer for George Washington University
            </div>
            <div class="rtd-footer-links">
                <a href="https://github.com/mmann1123/GWU_Course_Calendar" target="_blank" class="rtd-footer-link">
                    <svg class="github-icon" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                        <path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                    View on GitHub
                </a>
                <a href="https://github.com/mmann1123/GWU_Course_Calendar/issues" target="_blank" class="rtd-footer-link">
                    <svg class="github-icon" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                        <path fill="currentColor" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm9 3a1 1 0 11-2 0 1 1 0 012 0zM6.92 6.085c.081-.16.19-.299.34-.398.145-.097.371-.187.74-.187.28 0 .553.087.738.225A.613.613 0 019 6.25c0 .177-.04.264-.077.318a.956.956 0 01-.277.245c-.076.051-.158.1-.258.161l-.007.004a7.728 7.728 0 00-.313.195 2.416 2.416 0 00-.692.661.75.75 0 001.248.832.956.956 0 01.276-.245 6.3 6.3 0 01.26-.16l.006-.004c.093-.057.204-.123.313-.195.222-.149.487-.355.692-.662.214-.32.329-.702.329-1.15 0-.76-.36-1.348-.863-1.725A2.76 2.76 0 008 4c-.631 0-1.155.16-1.572.438-.413.276-.68.638-.849.977a.75.75 0 001.342.67z"/>
                    </svg>
                    Report Issue
                </a>
            </div>
        </div>
        <div class="rtd-footer-attribution">
            Credit: Michael Mann, Dept of Geography & Environment<br>
            Scraped on October 29, 2025 at 09:22 AM | Built with Python & BeautifulSoup
        </div>
    </footer>
</body>
</html>